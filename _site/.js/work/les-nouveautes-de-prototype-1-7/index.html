<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Prototype 1.7 new features &#8211; Site Title</title>
<meta name="description" content="Describe your website here.">
<meta name="keywords" content="">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Prototype 1.7 new features">
<meta property="og:description" content="Describe your website here.">
<meta property="og:url" content="/.js/work/les-nouveautes-de-prototype-1-7">
<meta property="og:site_name" content="Site Title">





<link rel="canonical" href="/.js/work/les-nouveautes-de-prototype-1-7">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Site Title Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post"  itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Your Name photo" class="author-photo">
					<h4>Your Name</h4>
					<p>Your bio goes here. It shouldn't be super long but a good two sentences or two should suffice.</p>
				</li>
				<li><a href="/about/">Learn More</a></li>
				<li>
					<a href="mailto:you@email.com"><i class="icon-envelope"></i> Email</a>
				</li>
				
				
				
				
				
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/archive/">All Posts</a></li>
				<li><a href="/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="/theme-setup">Theme Setup</a></li><li><a href="http://mademistakes.com">External Link</a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title" itemprop="name"><a href="/.js/work/les-nouveautes-de-prototype-1-7" rel="bookmark" title="Prototype 1.7 new features" itemprop="url">Prototype 1.7 new features</a></h1>
        
        <h2>November 20, 2010</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content" itemprop="description">
      <!--:en--><em>This blog post has not been translated, please find below the french version</em>

<strong>Màj : </strong>Voici <a href="http://prototypejs.org/2010/11/22/prototype-1-7">l'annonce officielle</a><br />
<h2>Introduction</h2>
Alors que la version 1.7 de <a href="http://prototypejs.org">Prototype</a>, le fameux framework JS, s'apprête à voir le jour. Nous allons, dans cet article, lister trois nouveautés majeures de cette version.
<h1>Element.Layout</h1>
Cette classe permet de fournir, avec un maximum de précision, tout un tas de mesures sur un élement. Il existe deux manières d'utiliser cette classe, voici la méthode du fainéant :
<pre class="brush: js"> $('elt').measure('margin-top'); // -&gt; retourne la marge haute en pixel de elt
 $('elt').measure('height'); // -&gt; retourne la hauteur en pixel de elt</pre>
Le fonctionnement de la deuxième ligne est similaire à l'utilisation de la méthode <a href="http://api.prototypejs.org/dom/Element/prototype/getHeight/">Element#getHeight()</a>. Une utilisation plus minutieuse pourrait ressembler à ça ;
<pre class="brush: js">var layout = $('elt').getLayout(true);
layout.get('margin-top'); // retourne la même hauteur que précédemment.
layout.get('height'); // retourne la même hauteur que précédemment.</pre>
L'avantage de la seconde méthode est que les valeurs de base nécessaire au calcul des dimensions sont mises en cache dans la variable layout et donc un seul appel est fait au DOM (gourmand en ressource).

Le paramètre "<em>true</em>" de <a href="http://api.prototypejs.org/dom/Element/prototype/getLayout/">Element#getLayout()</a> permet de forcer la récupération de toutes les valeurs d'un seul coup. Si ce paramètre est homis, les valeurs seront récupérées une par une et conservées en cache.

Pour des raisons d'optimisation, les anciennes méthodes <a href="http://api.prototypejs.org/dom/Element/prototype/getWidth/">Element#getWidth()</a> et <a href="http://api.prototypejs.org/dom/Element/prototype/getHeight/">Element#getHeight()</a> n'utilisent malheureusement pas cette méthode, mais utilisent l'ancienne méthode <a href="http://api.prototypejs.org/dom/Element/prototype/getDimensions/">Element#getDimensions()</a>.

La liste des propriétés mesurables est disponible à <a href="http://api.prototypejs.org/dom/Element/Layout/">cette adresse</a>.

Note 1 : Il faut bien garder à l'esprit que si les dimensions de l'élément, auquel votre layout fais référence, change, vous devrez créer un nouvelle instance de <a href="http://api.prototypejs.org/dom/Element/Layout/">Element.Layout</a>.

Note 2 : Si votre élément est masqué avec style "<em>diplay:none</em>" il vous sera possible d'effectuer des mesures uniquement si l'élément parent est visible. Par ailleurs les mesures <em>width</em>, <em>height</em>, <em>top</em>, <em>left</em>, <em>bottom</em> et <em>right</em> auront toujours pour valeur 0.
<h1>Event.Handler</h1>
L'un des problèmes de la délégation d'évènement avec les anciennes méthodes d'observation d'évènement est le ciblage de l'élement qui nous intéresse. Considérons pour les exemples suivant l'arbre HTML ci-dessous :
<pre class="brush: html">&lt;ul id="elt"&gt;
  &lt;li class="foo" data-code="un"&gt;&lt;a href="javascript:void(0);"&gt;un&lt;/a&gt;&lt;/li&gt;
  &lt;li class="foo" data-code="deux"&gt;&lt;a href="javascript:void(0);"&gt;deux&lt;/a&gt;&lt;/li&gt;
  &lt;li class="foo" data-code="trois"&gt;&lt;a href="javascript:void(0);"&gt;trois&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</pre>
Lorsque qu'un évènement est levé sur un élément il est levé sur tous ses parents récursivement, tant qu'il n'est pas arrêté explicitement ou qu'il a atteind la racine de l'arbre. On devait précédemment faire ce genre de chose :
<pre class="brush: js">var listener = function (evt) {
  var target = evt.findElement('.foo');
  if (!Object.isElement(target)) {
    return;
  }
  ... // traitement avec target, élement qui nous intéresse
}
$('elt').observe('click', listener);
... // et au besoin :
$('elt').stopObserving('click', listener);</pre>
Quand nous devions arrêter l'observation d'un évènement particulier il était fastidieux de devoir stocker la fonction assignée dans une variable bien précise afin de pouvoir la re-passer en paramètre à la méthode <a href="http://api.prototypejs.org/dom/Element/prototype/stopObserving/">Element#stopObserving()</a>.

Heureusement les développeurs de Prototype nous ont simplifié la tache avec la méthode <a href="http://api.prototypejs.org/dom/Element/prototype/on/">Element#on()</a>. Cette nouvelle méthode prend en paramètre un nouveau paramètre (un selecteur CSS) permettant de cibler exactement la cible qui nous intéresse. De plus elle renvoie une instance de <a href="http://api.prototypejs.org/dom/Event/Handler/">Element.Handler</a> qui possède des méthodes <a href="http://api.prototypejs.org/dom/Event/Handler/prototype/stop/">stop()</a> et <a href="http://api.prototypejs.org/dom/Event/Handler/prototype/start/">start()</a> qui permettent respectivement d'arrêter et de reprendre l'observation d'un évènement particulier. En voici un exemple d'utilisation :
<pre class="brush: js">var handler = $('elt').on('click', '.foo', function (evt, target) {
  ... // traitement avec target, élement qui nous intéresse
});
... // et au besoin :
handler.stop();
... // et de nouveau :
handler.start();</pre>
Pour compléter ces améliorations, une nouvelle méthode a été ajouté : <a href="http://api.prototypejs.org/dom/Element/prototype/purge/">Element#purge()</a> permettant de nettoyer un élément de tous les listeners d'évenement qui lui sont attachés.
<h1>Sizzle</h1>
<a href="http://sizzlejs.com/">Sizzle</a> est le nom du sélecteur CSS utilisé dans <a href="http://jquery.com/">jQuery</a>. Afin de pouvoir utiliser ce middleware partagé entre plusieurs frameworks, l'équipe de développement a fait un gros travail de modularité pour laisser le choix du moteur du traitement CSS. En effet, si vous souhaitez par exemple utiliser l'ancien moteur (présent depuis la version 1.5.1), il vous suffit de rapatrier le code source (via <a href="https://github.com/sstephenson/prototype">github</a> par exemple) et compiler prototype de la manière suivante :
<pre class="brush: shell;">rake dist SELECTOR_ENGINE=legacy_selector</pre>
De la même manière vous pouvez écrire votre propre moteur en le plaçant dans le répertoire vendor/ du package.
<h2>Conclusion</h2>
Les trois améliorations de la nouvelle mouture énoncées ci-dessus peuvent-être complétées par une ribambelle d'ajustements (notamment lié à IE9). Cette nouvelle version confirme les prétentions de la librairie visant à palier les manquements de compatibilités inter-navigateurs et simplifier considérablement le développement d'applications javascript, tout en restant le plus léger possible.<!--:--><!--:fr--><strong>Màj : </strong>Voici <a href="http://prototypejs.org/2010/11/22/prototype-1-7">l'annonce officielle</a><br />
<h2>Introduction</h2>
Alors que la version 1.7 de <a href="http://prototypejs.org">Prototype</a>, le fameux framework JS, s'apprête à voir le jour. Nous allons, dans cet article, lister trois nouveautés majeures de cette version.
<h1>Element.Layout</h1>
Cette classe permet de fournir, avec un maximum de précision, tout un tas de mesures sur un élement. Il existe deux manières d'utiliser cette classe, voici la méthode du fainéant :
<pre class="brush: js"> $('elt').measure('margin-top'); // -&gt; retourne la marge haute en pixel de elt
 $('elt').measure('height'); // -&gt; retourne la hauteur en pixel de elt</pre>
Le fonctionnement de la deuxième ligne est similaire à l'utilisation de la méthode <a href="http://api.prototypejs.org/dom/Element/prototype/getHeight/">Element#getHeight()</a>. Une utilisation plus minutieuse pourrait ressembler à ça ;
<pre class="brush: js">var layout = $('elt').getLayout(true);
layout.get('margin-top'); // retourne la même hauteur que précédemment.
layout.get('height'); // retourne la même hauteur que précédemment.</pre>
L'avantage de la seconde méthode est que les valeurs de base nécessaire au calcul des dimensions sont mises en cache dans la variable layout et donc un seul appel est fait au DOM (gourmand en ressource).

Le paramètre "<em>true</em>" de <a href="http://api.prototypejs.org/dom/Element/prototype/getLayout/">Element#getLayout()</a> permet de forcer la récupération de toutes les valeurs d'un seul coup. Si ce paramètre est homis, les valeurs seront récupérées une par une et conservées en cache.

Pour des raisons d'optimisation, les anciennes méthodes <a href="http://api.prototypejs.org/dom/Element/prototype/getWidth/">Element#getWidth()</a> et <a href="http://api.prototypejs.org/dom/Element/prototype/getHeight/">Element#getHeight()</a> n'utilisent malheureusement pas cette méthode, mais utilisent l'ancienne méthode <a href="http://api.prototypejs.org/dom/Element/prototype/getDimensions/">Element#getDimensions()</a>.

La liste des propriétés mesurables est disponible à <a href="http://api.prototypejs.org/dom/Element/Layout/">cette adresse</a>.

Note 1 : Il faut bien garder à l'esprit que si les dimensions de l'élément, auquel votre layout fais référence, change, vous devrez créer un nouvelle instance de <a href="http://api.prototypejs.org/dom/Element/Layout/">Element.Layout</a>.

Note 2 : Si votre élément est masqué avec style "<em>diplay:none</em>" il vous sera possible d'effectuer des mesures uniquement si l'élément parent est visible. Par ailleurs les mesures <em>width</em>, <em>height</em>, <em>top</em>, <em>left</em>, <em>bottom</em> et <em>right</em> auront toujours pour valeur 0.
<h1>Event.Handler</h1>
L'un des problèmes de la délégation d'évènement avec les anciennes méthodes d'observation d'évènement est le ciblage de l'élement qui nous intéresse. Considérons pour les exemples suivant l'arbre HTML ci-dessous :
<pre class="brush: html">&lt;ul id="elt"&gt;
  &lt;li class="foo" data-code="un"&gt;&lt;a href="javascript:void(0);"&gt;un&lt;/a&gt;&lt;/li&gt;
  &lt;li class="foo" data-code="deux"&gt;&lt;a href="javascript:void(0);"&gt;deux&lt;/a&gt;&lt;/li&gt;
  &lt;li class="foo" data-code="trois"&gt;&lt;a href="javascript:void(0);"&gt;trois&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</pre>
Lorsque qu'un évènement est levé sur un élément il est levé sur tous ses parents récursivement, tant qu'il n'est pas arrêté explicitement ou qu'il a atteind la racine de l'arbre. On devait précédemment faire ce genre de chose :
<pre class="brush: js">var listener = function (evt) {
  var target = evt.findElement('.foo');
  if (!Object.isElement(target)) {
    return;
  }
  ... // traitement avec target, élement qui nous intéresse
}
$('elt').observe('click', listener);
... // et au besoin :
$('elt').stopObserving('click', listener);</pre>
Quand nous devions arrêter l'observation d'un évènement particulier il était fastidieux de devoir stocker la fonction assignée dans une variable bien précise afin de pouvoir la re-passer en paramètre à la méthode <a href="http://api.prototypejs.org/dom/Element/prototype/stopObserving/">Element#stopObserving()</a>.

Heureusement les développeurs de Prototype nous ont simplifié la tache avec la méthode <a href="http://api.prototypejs.org/dom/Element/prototype/on/">Element#on()</a>. Cette nouvelle méthode prend en paramètre un nouveau paramètre (un selecteur CSS) permettant de cibler exactement la cible qui nous intéresse. De plus elle renvoie une instance de <a href="http://api.prototypejs.org/dom/Event/Handler/">Element.Handler</a> qui possède des méthodes <a href="http://api.prototypejs.org/dom/Event/Handler/prototype/stop/">stop()</a> et <a href="http://api.prototypejs.org/dom/Event/Handler/prototype/start/">start()</a> qui permettent respectivement d'arrêter et de reprendre l'observation d'un évènement particulier. En voici un exemple d'utilisation :
<pre class="brush: js">var handler = $('elt').on('click', '.foo', function (evt, target) {
  ... // traitement avec target, élement qui nous intéresse
});
... // et au besoin :
handler.stop();
... // et de nouveau :
handler.start();</pre>
Pour compléter ces améliorations, une nouvelle méthode a été ajouté : <a href="http://api.prototypejs.org/dom/Element/prototype/purge/">Element#purge()</a> permettant de nettoyer un élément de tous les listeners d'évenement qui lui sont attachés.
<h1>Sizzle</h1>
<a href="http://sizzlejs.com/">Sizzle</a> est le nom du sélecteur CSS utilisé dans <a href="http://jquery.com/">jQuery</a>. Afin de pouvoir utiliser ce middleware partagé entre plusieurs frameworks, l'équipe de développement a fait un gros travail de modularité pour laisser le choix du moteur du traitement CSS. En effet, si vous souhaitez par exemple utiliser l'ancien moteur (présent depuis la version 1.5.1), il vous suffit de rapatrier le code source (via <a href="https://github.com/sstephenson/prototype">github</a> par exemple) et compiler prototype de la manière suivante :
<pre class="brush: shell;">rake dist SELECTOR_ENGINE=legacy_selector</pre>
De la même manière vous pouvez écrire votre propre moteur en le plaçant dans le répertoire vendor/ du package.
<h2>Conclusion</h2>
Les trois améliorations de la nouvelle mouture énoncées ci-dessus peuvent-être complétées par une ribambelle d'ajustements (notamment lié à IE9). Cette nouvelle version confirme les prétentions de la librairie visant à palier les manquements de compatibilités inter-navigateurs et simplifier considérablement le développement d'applications javascript, tout en restant le plus léger possible.<!--:-->

      <footer class="entry-meta">
        <span class="entry-tags"></span>
        <span><a href="/.js/work/les-nouveautes-de-prototype-1-7" rel="bookmark" title="Prototype 1.7 new features" itemprop="url">Prototype 1.7 new features</a></span>
        was published on <span class="entry-date date published updated"><time datetime="2010-11-20T00:00:00-05:00" itemprop="datePublished">November 20, 2010</span></time>
        
        <span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="/about" title="About Your Name" itemprop="url">Your Name</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="/shelf/so-i-made-it" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="/.wicket/wicket-1-4-9-tinymce" title="Wicket 1.4.x - TinyMCE">Wicket 1.4.x - TinyMCE</a></h3>
          <p>This blog post has not been translated, please find below the french versionMàj : Voici l'annonce officielleIntroductionAlors que la vers...&hellip; <a href="/.wicket/wicket-1-4-9-tinymce">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
          <div class="list-item">
            <h4><a href="/.android/android-switcher-widget" title="Android Switcher Widget">Android Switcher Widget</a></h4>
            <span>Published on October 29, 2010</span>
          </div><!-- /.list-item -->
        
          <div class="list-item">
            <h4><a href="/.java/.maven/work/getting-source-revision-for-a-deployed-app-using-maven-and-a-servlet" title="Getting source revision for a deployed app using Maven and a Servlet">Getting source revision for a deployed app using Maven and a Servlet</a></h4>
            <span>Published on November 01, 2010</span>
          </div><!-- /.list-item -->
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2013 Your Name. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>

	        

</body>
</html>
