<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Continuous delivery using Maven / Shell &#8211; Site Title</title>
<meta name="description" content="Describe your website here.">
<meta name="keywords" content="deploy, github, glassfish, maven, shell">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Continuous delivery using Maven / Shell">
<meta property="og:description" content="Describe your website here.">
<meta property="og:url" content="/.java/.maven/continuous-delivery-using-maven-shell">
<meta property="og:site_name" content="Site Title">





<link rel="canonical" href="/.java/.maven/continuous-delivery-using-maven-shell">
<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Site Title Feed">


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.min.css">
<!-- Webfonts -->
<link href="http://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post"  itemscope itemtype="http://schema.org/WebPage">

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->
<nav id="dl-menu" class="dl-menuwrapper" role="navigation" itemscope itemtype="http://schema.org/SiteNavigationElement">
	<button class="dl-trigger">Open Menu</button>
	<ul class="dl-menu">
		<li><a href="">Home</a></li>
		<li>
			<a href="#">About</a>
			<ul class="dl-submenu">
				<li>
					<img src="/images/avatar.jpg" alt="Your Name photo" class="author-photo">
					<h4>Your Name</h4>
					<p>Your bio goes here. It shouldn't be super long but a good two sentences or two should suffice.</p>
				</li>
				<li><a href="/about/">Learn More</a></li>
				<li>
					<a href="mailto:you@email.com"><i class="icon-envelope"></i> Email</a>
				</li>
				
				
				
				
				
				
				
				
				
			</ul><!-- /.dl-submenu -->
		</li>
		<li>
			<a href="#">Posts</a>
			<ul class="dl-submenu">
				<li><a href="/archive/">All Posts</a></li>
				<li><a href="/tags/">All Tags</a></li>
			</ul>
		</li>
		<li><a href="/theme-setup">Theme Setup</a></li><li><a href="http://mademistakes.com">External Link</a></li>
	</ul><!-- /.dl-menu -->
</nav><!-- /.dl-menuwrapper -->




<div id="main" role="main" itemprop="mainContentOfPage" itemscope itemtype="http://schema.org/Blog">
  <article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
    <header class="header-title">
      <div class="header-title-wrap">
        
          <h1 class="entry-title" itemprop="name"><a href="/.java/.maven/continuous-delivery-using-maven-shell" rel="bookmark" title="Continuous delivery using Maven / Shell" itemprop="url">Continuous delivery using Maven / Shell</a></h1>
        
        <h2>September 04, 2011</h2>
      </div><!-- /.header-title-wrap -->
    </header>
    <div class="entry-content" itemprop="description">
      <!--:en--><h2>Continuous delivery</h2>
<a href="http://www.bloggure.info/work/getting-source-revision-for-a-deployed-app-using-maven-and-a-servlet.html/attachment/maven_logo-2" rel="attachment wp-att-74"><img src="http://www.bloggure.info/wp-content/uploads/2010/11/Maven_logo1.gif" alt="" title="Maven" width="304" height="78" class="alignright size-full wp-image-74" /></a>
After Continuous Integration, this is the word we see on the web these days. Its meaning is really simple, it consists in reducing steps in application deployment. In order to do so a set of tools actually exists, you can use the same PaaS images (thanks to the newcomer <a href="http://blogs.vmware.com/console/2011/08/micro-cloud-foundry-open-paas-on-your-laptop-available-today.html">Micro Cloud Foundry by VMWare</a> or  use a special amazon ec2 instance) to have a development environment similar to production one. And you can use <a href="http://wiki.opscode.com/display/chef/Home">Chef</a> to manage and automate your configuration. While these alternatives are really interesting, I think they are way too powerful and difficult to setup in simple cases.
I will explain my "simple" solution based on maven, shell scripts and hostname detection.

<h2>Example release archive</h2>
An example is better than a thousand words, you will find an example of my solution in a github repository <a href="https://github.com/CedricGatay/easy-release-archive">Easy Release Archive</a>. It is a maven project building a zip artifact containing everything to be deployed, and an example script to setup the Glassfish server.
<h3>What is inside ?</h3>
To understand how it works, the best thing is to look what's inside.
<ul>
<li>an <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/assembly/assembly.xml">assembly.xml file</a> describing the files to include and their output name and location.</li>
<li>a few scripts in /src/main/resources
<ul>
<li><a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/sanityCheck.sh">sanityCheck.sh</a> : helper script sourcing the correct variables depending on the hostname of the machine and ensuring variables are correctly setup</li>
<li><a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/setupGlassfish.sh">setupGlassfish.sh</a> : a sample script used to setup a Glassfish server with its required datasources and other parameters</li>
<li>a <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/global">global</a> folder containing global configuration files</li>
<li>a per hostname folder (in my case <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp">samva-mbp</a>) containing a <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/samva-mbp/shell/envSetup.sh">shell/envSetup.sh</a> shell script to setup necessary variables and a <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp/config">config</a> folder for special environment configuration files.
</ul>
</li>
<li>the <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/pom.xml">pom.xml</a> file describing artifact versions to use in the assembly and the lifecycle to use.</li>
</ul>

A simple mvn package will build the zip archive with everything described in the assembly.xml file. You will just have to unzip and run the script(s) corresponding to the application deployment for it to be done. You can add this command line to your build server and you will have a simple but powerful continuous delivery system !<!--:--><!--:fr--><h2>Livraison continue</h2>
<a href="http://www.bloggure.info/work/getting-source-revision-for-a-deployed-app-using-maven-and-a-servlet.html/attachment/maven_logo-2" rel="attachment wp-att-74"><img src="http://www.bloggure.info/wp-content/uploads/2010/11/Maven_logo1.gif" alt="" title="Maven" width="304" height="78" class="alignright size-full wp-image-74" /></a>
Après l'intégration continue, c'est le mot à la mode sur le web ces derniers temps. Le concept est très simple, ceci consiste à réduire le nomrbe d'étapes nécessaires au déploiement d'une application. Pour le mettre en pratique il y a plusieurs solutions, utiliser un environnement PaaS similaire pour vos développements et la production (en utilisant la nouveauté <a href="http://blogs.vmware.com/console/2011/08/micro-cloud-foundry-open-paas-on-your-laptop-available-today.html">Micro Cloud Foundry de VMWare</a>, utiliser une instance EC2 spéciale). Et vous pouvez utiliser <a href="http://wiki.opscode.com/display/chef/Home">Chef</a> pour gérer et automatiser votre configuration. Bien que ces solutions soient très interessantes, je trouve qu'elles sont finalement trop puissante et difficile à mettre en oeuvre dans des cas simples.
Je vais expliquer ici ma solution "simple" utilisant maven, des scripts shell et la détection du nom de la machine.

<h2>Exemple d'archive de livraison</h2>
Comme un exemple est mieux que des milliers de mots, vous trouverez un exemple de ma solution dans un dépot github <a href="https://github.com/CedricGatay/easy-release-archive">Easy Release Archive</a>. C'est un projet maven construisant un fichier zip contenant tout ce qui doit être déployé, et un script d'exemple pour configurer le serveur Glassfish.
<h3>Quel contenu ?</h3>
Pour comprendre comment il fonctionne, la meilleure chose à faire est de regarder son contenu
<ul>
<li>un <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/assembly/assembly.xml">fichier assembly.xml</a> décrivant les fichiers à inclure, leurs noms finaux et leurs localisations.</li>
<li>quelques scripts dans /src/main/resources
<ul>
<li><a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/sanityCheck.sh">sanityCheck.sh</a> : un script permettant de charger les variables en fonction du nom d'hôte de la machine et de s'assurer que les variables nécessaires sont correctement configurées</li>
<li><a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/setupGlassfish.sh">setupGlassfish.sh</a> : un script simple permettant de configurer un serveur Glassfish avec les datasources et d'autres paramètres</li>
<li>un dossier <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/global">global</a> contenant les ficheirs de configuration globaux</li>
<li>un dossier par nom d'hôte (dans mon cas <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp">samva-mbp</a>) contenant un script shell <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/samva-mbp/shell/envSetup.sh">shell/envSetup.sh</a> permettant de configurer les variables nécessaires et un dossier <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp/config">config</a> pour les fichiers de configuration propres à l'environnement.
</ul>
</li>
<li>un fichier <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/pom.xml">pom.xml</a> file décrivant les versions des artefacts à utiliser dans la construction du fichier zip et le cycle de vie maven à adopter.</li>
</ul>

Un simple mvn package permettra de construire l'archive zip contenant tout ce qui est décrit dans le fichier assembly.xml. Il suffira ensuite de décompresser le zip et d'exécuter le ou les scripts correspondant au déploiement pour que celui-ci se fasse simplement, on peut même demander à son serveur d'intégration continue de le faire pour avoir un système simple mais puissant de livraison continue.<!--:-->

      <footer class="entry-meta">
        <span class="entry-tags"><a href="/tags/index.html#deploy" title="Pages tagged deploy" rel="tag" class="tag">deploy</a><a href="/tags/index.html#github" title="Pages tagged github" rel="tag" class="tag">github</a><a href="/tags/index.html#glassfish" title="Pages tagged glassfish" rel="tag" class="tag">glassfish</a><a href="/tags/index.html#maven" title="Pages tagged maven" rel="tag" class="tag">maven</a><a href="/tags/index.html#shell" title="Pages tagged shell" rel="tag" class="tag">shell</a></span>
        <span><a href="/.java/.maven/continuous-delivery-using-maven-shell" rel="bookmark" title="Continuous delivery using Maven / Shell" itemprop="url">Continuous delivery using Maven / Shell</a></span>
        was published on <span class="entry-date date published updated"><time datetime="2011-09-04T00:00:00-04:00" itemprop="datePublished">September 04, 2011</span></time>
        
        <span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="/about" title="About Your Name" itemprop="url">Your Name</a></span></span>
        
      </footer>
    </div><!-- /.entry-content -->
    
    
    <div class="read-more">
      
        <div class="read-more-header">
          <a href="/.java/.wicket/work/intellij-external-library-propertykey-how-to" class="read-more-btn">Read More</a>
        </div><!-- /.read-more-header -->
        <div class="read-more-content">
          <h3><a href="/.wicket/wicket-1-4-9-tinymce" title="Wicket 1.4.x - TinyMCE">Wicket 1.4.x - TinyMCE</a></h3>
          <p>Continuous deliveryAfter Continuous Integration, this is the word we see on the web these days. Its meaning is really simple, it consists...&hellip; <a href="/.wicket/wicket-1-4-9-tinymce">Continue reading</a></p>
        </div><!-- /.read-more-content -->
      
      <div class="read-more-list">
        
          <div class="list-item">
            <h4><a href="/.android/android-switcher-widget" title="Android Switcher Widget">Android Switcher Widget</a></h4>
            <span>Published on October 29, 2010</span>
          </div><!-- /.list-item -->
        
          <div class="list-item">
            <h4><a href="/.java/.maven/work/getting-source-revision-for-a-deployed-app-using-maven-and-a-servlet" title="Getting source revision for a deployed app using Maven and a Servlet">Getting source revision for a deployed app using Maven and a Servlet</a></h4>
            <span>Published on November 01, 2010</span>
          </div><!-- /.list-item -->
        
      </div><!-- /.read-more-list -->
      
    </div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2013 Your Name. Powered by <a href="http://jekyllrb.com">Jekyll</a> using the <a href="http://mademistakes.com/">HPSTR Theme</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="/assets/js/scripts.min.js"></script>

	        

</body>
</html>
