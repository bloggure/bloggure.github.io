<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>Continuous delivery using Maven / Shell &#8211; Bloggure</title>
    <meta
      name="description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta name="keywords" content="deploy, github, glassfish, maven, shell" />

    <!-- Open Graph -->
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta
      property="og:title"
      content="Continuous delivery using Maven / Shell"
    />
    <meta
      property="og:description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta
      property="og:url"
      content="http://www.bloggure.info/.java/.maven/continuous-delivery-using-maven-shell"
    />
    <meta property="og:site_name" content="Bloggure" />

    <link
      rel="canonical"
      href="http://www.bloggure.info/.java/.maven/continuous-delivery-using-maven-shell"
    />
    <link
      href="http://www.bloggure.info/feed.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Bloggure Feed"
    />

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- For all browsers -->
    <link
      rel="stylesheet"
      href="http://www.bloggure.info/assets/css/main.css"
    />
    <!-- Webfonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic"
      rel="stylesheet"
      type="text/css"
    />

    <meta http-equiv="cleartype" content="on" />

    <!-- Load Modernizr -->
    <script src="http://www.bloggure.info/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

    <!-- Icons -->
    <!-- 16x16 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.ico" />
    <!-- 32x32 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.png" />
    <!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
    <link
      rel="apple-touch-icon-precomposed"
      href="http://www.bloggure.info/images/apple-touch-icon-precomposed.png"
    />
    <!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="72x72"
      href="http://www.bloggure.info/images/apple-touch-icon-72x72-precomposed.png"
    />
    <!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="114x114"
      href="http://www.bloggure.info/images/apple-touch-icon-114x114-precomposed.png"
    />
    <!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="144x144"
      href="http://www.bloggure.info/images/apple-touch-icon-144x144-precomposed.png"
    />
  </head>

  <body id="post">
    <!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

    <div class="entry-header">
      <header class="header-title">
        <div class="header-title-wrap">
          <h1 class="entry-title" itemprop="name">
            <a href="http://www.bloggure.info/">Bloggure</a>
          </h1>
        </div>
        <!-- /.header-title-wrap -->
      </header>
    </div>

    <div id="main" role="main">
      <article class="hentry">
        <div class="entry-content">
          <header>
            <div class="entry-meta">
              <span class="entry-date date published updated"
                ><time
                  datetime="2011-09-04T00:00:00+02:00"
                  itemprop="datePublished"
                  ><a
                    href="http://www.bloggure.info/.java/.maven/continuous-delivery-using-maven-shell"
                    >September 04, 2011</a
                  ></time
                ></span
              ><span
                class="author vcard"
                itemprop="author"
                itemscope
                itemtype="http://schema.org/Person"
                ><span itemprop="name" class="fn"
                  ><a
                    href="http://www.bloggure.info/cgatay"
                    title="About cgatay"
                    itemprop="url"
                    >cgatay</a
                  ></span
                ></span
              >&nbsp; &bull; &nbsp;<span class="entry-comments"
                ><a
                  href="http://www.bloggure.info/.java/.maven/continuous-delivery-using-maven-shell#disqus_thread"
                  >Comment</a
                ></span
              >
            </div>
            <!-- /.entry-meta -->

            <h1 class="entry-title" itemprop="name">
              <a
                href="http://www.bloggure.info/.java/.maven/continuous-delivery-using-maven-shell"
                rel="bookmark"
                title="Continuous delivery using Maven / Shell"
                itemprop="url"
                >Continuous delivery using Maven / Shell</a
              >
            </h1>
          </header>
          <!--:en-->
          <h2>Continuous delivery</h2>
          <img
            src="/images/uploads/2010/11/Maven_logo1.gif"
            alt=""
            title="Maven"
            width="304"
            height="78"
            class="alignright size-full wp-image-74"
          />
          <p>
            After Continuous Integration, this is the word we see on the web
            these days. Its meaning is really simple, it consists in reducing
            steps in application deployment. In order to do so a set of tools
            actually exists, you can use the same PaaS images (thanks to the
            newcomer
            <a
              href="http://blogs.vmware.com/console/2011/08/micro-cloud-foundry-open-paas-on-your-laptop-available-today.html"
              >Micro Cloud Foundry by VMWare</a
            >
            or use a special amazon ec2 instance) to have a development
            environment similar to production one. And you can use
            <a href="http://wiki.opscode.com/display/chef/Home">Chef</a> to
            manage and automate your configuration. While these alternatives are
            really interesting, I think they are way too powerful and difficult
            to setup in simple cases.<br />
            I will explain my "simple" solution based on maven, shell scripts
            and hostname detection.
          </p>

          <h2>Example release archive</h2>
          <p>
            An example is better than a thousand words, you will find an example
            of my solution in a github repository
            <a href="https://github.com/CedricGatay/easy-release-archive"
              >Easy Release Archive</a
            >. It is a maven project building a zip artifact containing
            everything to be deployed, and an example script to setup the
            Glassfish server.
          </p>
          <h3>What is inside ?</h3>
          <p>
            To understand how it works, the best thing is to look what's inside.
          </p>
          <ul>
            <li>
              an
              <a
                href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/assembly/assembly.xml"
                >assembly.xml file</a
              >
              describing the files to include and their output name and
              location.
            </li>
            <li>
              a few scripts in /src/main/resources
              <ul>
                <li>
                  <a
                    href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/sanityCheck.sh"
                    >sanityCheck.sh</a
                  >
                  : helper script sourcing the correct variables depending on
                  the hostname of the machine and ensuring variables are
                  correctly setup
                </li>
                <li>
                  <a
                    href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/setupGlassfish.sh"
                    >setupGlassfish.sh</a
                  >
                  : a sample script used to setup a Glassfish server with its
                  required datasources and other parameters
                </li>
                <li>
                  a
                  <a
                    href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/global"
                    >global</a
                  >
                  folder containing global configuration files
                </li>
                <li>
                  a per hostname folder (in my case
                  <a
                    href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp"
                    >samva-mbp</a
                  >) containing a
                  <a
                    href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/samva-mbp/shell/envSetup.sh"
                    >shell/envSetup.sh</a
                  >
                  shell script to setup necessary variables and a
                  <a
                    href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp/config"
                    >config</a
                  >
                  folder for special environment configuration files.
                </li>
              </ul>
            </li>
            <li>
              the
              <a
                href="https://github.com/CedricGatay/easy-release-archive/blob/master/pom.xml"
                >pom.xml</a
              >
              file describing artifact versions to use in the assembly and the
              lifecycle to use.
            </li>
          </ul>

          <p>
            A simple mvn package will build the zip archive with everything
            described in the assembly.xml file. You will just have to unzip and
            run the script(s) corresponding to the application deployment for it
            to be done. You can add this command line to your build server and
            you will have a simple but powerful continuous delivery system !
          </p>
          <!--:--><!--:fr<h2>Livraison continue</h2>
<a href="http://www.bloggure.info/work/getting-source-revision-for-a-deployed-app-using-maven-and-a-servlet.html/attachment/maven_logo-2" rel="attachment wp-att-74"><img src="/images/uploads/2010/11/Maven_logo1.gif" alt="" title="Maven" width="304" height="78" class="alignright size-full wp-image-74" /></a>
Après l'intégration continue, c'est le mot à la mode sur le web ces derniers temps. Le concept est très simple, ceci consiste à réduire le nomrbe d'étapes nécessaires au déploiement d'une application. Pour le mettre en pratique il y a plusieurs solutions, utiliser un environnement PaaS similaire pour vos développements et la production (en utilisant la nouveauté <a href="http://blogs.vmware.com/console/2011/08/micro-cloud-foundry-open-paas-on-your-laptop-available-today.html">Micro Cloud Foundry de VMWare</a>, utiliser une instance EC2 spéciale). Et vous pouvez utiliser <a href="http://wiki.opscode.com/display/chef/Home">Chef</a> pour gérer et automatiser votre configuration. Bien que ces solutions soient très interessantes, je trouve qu'elles sont finalement trop puissante et difficile à mettre en oeuvre dans des cas simples.
Je vais expliquer ici ma solution "simple" utilisant maven, des scripts shell et la détection du nom de la machine.

<h2>Exemple d'archive de livraison</h2>
Comme un exemple est mieux que des milliers de mots, vous trouverez un exemple de ma solution dans un dépot github <a href="https://github.com/CedricGatay/easy-release-archive">Easy Release Archive</a>. C'est un projet maven construisant un fichier zip contenant tout ce qui doit être déployé, et un script d'exemple pour configurer le serveur Glassfish.
<h3>Quel contenu ?</h3>
Pour comprendre comment il fonctionne, la meilleure chose à faire est de regarder son contenu
<ul>
<li>un <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/assembly/assembly.xml">fichier assembly.xml</a> décrivant les fichiers à inclure, leurs noms finaux et leurs localisations.</li>
<li>quelques scripts dans /src/main/resources
<ul>
<li><a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/sanityCheck.sh">sanityCheck.sh</a> : un script permettant de charger les variables en fonction du nom d'hôte de la machine et de s'assurer que les variables nécessaires sont correctement configurées</li>
<li><a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/setupGlassfish.sh">setupGlassfish.sh</a> : un script simple permettant de configurer un serveur Glassfish avec les datasources et d'autres paramètres</li>
<li>un dossier <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/global">global</a> contenant les ficheirs de configuration globaux</li>
<li>un dossier par nom d'hôte (dans mon cas <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp">samva-mbp</a>) contenant un script shell <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/src/main/resources/samva-mbp/shell/envSetup.sh">shell/envSetup.sh</a> permettant de configurer les variables nécessaires et un dossier <a href="https://github.com/CedricGatay/easy-release-archive/tree/master/src/main/resources/samva-mbp/config">config</a> pour les fichiers de configuration propres à l'environnement.
</ul>
</li>
<li>un fichier <a href="https://github.com/CedricGatay/easy-release-archive/blob/master/pom.xml">pom.xml</a> file décrivant les versions des artefacts à utiliser dans la construction du fichier zip et le cycle de vie maven à adopter.</li>
</ul>

Un simple mvn package permettra de construire l'archive zip contenant tout ce qui est décrit dans le fichier assembly.xml. Il suffira ensuite de décompresser le zip et d'exécuter le ou les scripts correspondant au déploiement pour que celui-ci se fasse simplement, on peut même demander à son serveur d'intégration continue de le faire pour avoir un système simple mais puissant de livraison continue.<-->

          <footer class="entry-meta">
            <span class="entry-tags"
              ><a
                href="http://www.bloggure.info/tags/#deploy"
                title="Pages tagged deploy"
                class="tag"
                ><span class="term">deploy</span></a
              ><a
                href="http://www.bloggure.info/tags/#github"
                title="Pages tagged github"
                class="tag"
                ><span class="term">github</span></a
              ><a
                href="http://www.bloggure.info/tags/#glassfish"
                title="Pages tagged glassfish"
                class="tag"
                ><span class="term">glassfish</span></a
              ><a
                href="http://www.bloggure.info/tags/#maven"
                title="Pages tagged maven"
                class="tag"
                ><span class="term">maven</span></a
              ><a
                href="http://www.bloggure.info/tags/#shell"
                title="Pages tagged shell"
                class="tag"
                ><span class="term">shell</span></a
              ></span
            >

            <div class="social-share">
              <ul class="socialcount socialcount-small inline-list">
                <li class="facebook">
                  <a
                    href="https://www.facebook.com/sharer/sharer.php?u=http://www.bloggure.info/.java/.maven/continuous-delivery-using-maven-shell"
                    title="Share on Facebook"
                    ><span class="count"
                      ><i class="fa fa-facebook-square"></i> Like</span
                    ></a
                  >
                </li>
                <li class="twitter">
                  <a
                    href="https://twitter.com/intent/tweet?text=http://www.bloggure.info/.java/.maven/continuous-delivery-using-maven-shell"
                    title="Share on Twitter"
                    ><span class="count"
                      ><i class="fa fa-twitter-square"></i> Tweet</span
                    ></a
                  >
                </li>
              </ul>
            </div>
            <!-- /.social-share -->
          </footer>
        </div>
        <!-- /.entry-content -->
        <section id="disqus_thread"></section>
        <!-- /#disqus_thread -->
        <div class="read-more">
          <div class="read-more-header">
            <a
              href="http://www.bloggure.info/.java/.wicket/work/intellij-external-library-propertykey-how-to"
              class="read-more-btn"
              >Read More</a
            >
          </div>
          <!-- /.read-more-header -->
          <div class="read-more-content">
            <h3>
              <a
                href="http://www.bloggure.info/iOS-DarkModeBackground-App-Switcher"
                title="Dark Mode iOS Snapshot"
                >Dark Mode iOS Snapshot</a
              >
            </h3>
            <p>
              # Dark mode supportAs you might know, iOS supports Dark mode since
              iOS 12. It is pretty straightforward to implement it by using
              dynamic ...&hellip;
              <a
                href="http://www.bloggure.info/iOS-DarkModeBackground-App-Switcher"
                >Continue reading</a
              >
            </p>
          </div>
          <!-- /.read-more-content -->

          <div class="read-more-list">
            <div class="list-item">
              <h4>
                <a href="http://www.bloggure.info/git-gone" title="Git-gone"
                  >Git-gone</a
                >
              </h4>
              <span>Published on December 31, 2020</span>
            </div>
            <!-- /.list-item -->

            <div class="list-item">
              <h4>
                <a
                  href="http://www.bloggure.info/mac-checklist"
                  title="macOS tools checklist"
                  >macOS tools checklist</a
                >
              </h4>
              <span>Published on December 06, 2020</span>
            </div>
            <!-- /.list-item -->
          </div>
          <!-- /.read-more-list -->
        </div>
        <!-- /.read-more -->
      </article>
    </div>
    <!-- /#main -->

    <div class="footer-wrapper">
      <footer role="contentinfo">
        <span
          >&copy; 2021 . Powered by
          <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using a theme
          based on
          <a
            href="https://mademistakes.com/work/hpstr-jekyll-theme/"
            rel="nofollow"
            >HPSTR</a
          >.</span
        >
      </footer>
    </div>
    <!-- /.footer-wrapper -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
      window.jQuery ||
        document.write(
          '<script src="http://www.bloggure.info/assets/js/vendor/jquery-1.9.1.min.js"><\/script>'
        );
    </script>
    <script src="http://www.bloggure.info/assets/js/scripts.min.js"></script>

    <!-- Asynchronous Google Analytics snippet -->
    <script>
      (function (i, s, o, g, r, a, m) {
        i["GoogleAnalyticsObject"] = r;
        (i[r] =
          i[r] ||
          function () {
            (i[r].q = i[r].q || []).push(arguments);
          }),
          (i[r].l = 1 * new Date());
        (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(
        window,
        document,
        "script",
        "//www.google-analytics.com/analytics.js",
        "ga"
      );

      ga("create", "UA-11718843-3", "auto");
      ga("require", "linkid", "linkid.js");
      ga("send", "pageview");
    </script>

    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = "thereisnoplacelike1"; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var dsq = document.createElement("script");
        dsq.type = "text/javascript";
        dsq.async = true;
        dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
        (
          document.getElementsByTagName("head")[0] ||
          document.getElementsByTagName("body")[0]
        ).appendChild(dsq);
      })();

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var s = document.createElement("script");
        s.async = true;
        s.type = "text/javascript";
        s.src = "//" + disqus_shortname + ".disqus.com/count.js";
        (
          document.getElementsByTagName("HEAD")[0] ||
          document.getElementsByTagName("BODY")[0]
        ).appendChild(s);
      })();
    </script>
    <noscript
      >Please enable JavaScript to view the
      <a href="http://disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >
    <a href="http://disqus.com" class="dsq-brlink"
      >comments powered by <span class="logo-disqus">Disqus</span></a
    >
  </body>
</html>
