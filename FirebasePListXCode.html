<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>Firebase + XCode &#8211; Bloggure</title>
    <meta
      name="description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta name="keywords" content="XCode, Firebase" />

    <!-- Open Graph -->
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Firebase + XCode" />
    <meta
      property="og:description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta
      property="og:url"
      content="http://www.bloggure.info/FirebasePListXCode"
    />
    <meta property="og:site_name" content="Bloggure" />

    <link rel="canonical" href="http://www.bloggure.info/FirebasePListXCode" />
    <link
      href="http://www.bloggure.info/feed.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Bloggure Feed"
    />

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- For all browsers -->
    <link
      rel="stylesheet"
      href="http://www.bloggure.info/assets/css/main.css"
    />
    <!-- Webfonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic"
      rel="stylesheet"
      type="text/css"
    />

    <meta http-equiv="cleartype" content="on" />

    <script>
      document.documentElement.className = document.documentElement.className.replace(
        /\bno-js\b/,
        "js"
      );
    </script>

    <!-- Icons -->
    <!-- 16x16 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.ico" />
    <!-- 32x32 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.png" />
    <!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
    <link
      rel="apple-touch-icon-precomposed"
      href="http://www.bloggure.info/images/apple-touch-icon-precomposed.png"
    />
    <!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="72x72"
      href="http://www.bloggure.info/images/apple-touch-icon-72x72-precomposed.png"
    />
    <!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="114x114"
      href="http://www.bloggure.info/images/apple-touch-icon-114x114-precomposed.png"
    />
    <!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="144x144"
      href="http://www.bloggure.info/images/apple-touch-icon-144x144-precomposed.png"
    />
  </head>

  <body id="post">
    <!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

    <div class="entry-header">
      <header class="header-title">
        <div class="header-title-wrap">
          <h1 class="entry-title" itemprop="name">
            <a href="http://www.bloggure.info/">Bloggure</a>
          </h1>
        </div>
        <!-- /.header-title-wrap -->
      </header>
    </div>

    <div id="main" role="main">
      <article class="hentry">
        <div class="entry-content">
          <header>
            <div class="entry-meta">
              <span class="entry-date date published updated"
                ><time
                  datetime="2018-03-13T00:00:00+01:00"
                  itemprop="datePublished"
                  ><a href="http://www.bloggure.info/FirebasePListXCode"
                    >March 13, 2018</a
                  ></time
                ></span
              ><span
                class="author vcard"
                itemprop="author"
                itemscope
                itemtype="http://schema.org/Person"
                ><span itemprop="name" class="fn"
                  ><a
                    href="http://www.bloggure.info/Cedric"
                    title="About Cedric"
                    itemprop="url"
                    >Cedric</a
                  ></span
                ></span
              >
            </div>
            <!-- /.entry-meta -->

            <h1 class="entry-title" itemprop="name">
              <a
                href="http://www.bloggure.info/FirebasePListXCode"
                rel="bookmark"
                title="Firebase + XCode"
                itemprop="url"
                >Firebase + XCode</a
              >
            </h1>
          </header>
          <div class="paragraph">
            <p>
              Il est courant maintenant d&#8217;utiliser Firebase dans les
              applications mobiles. Que ce soit pour la partie statistiques, les
              notifications ou le reporting des <em>crashes</em>.
              L&#8217;intégration est très facile, mais peut devenir compliquée
              dès lors qu&#8217;on manipule des <em>target</em> différentes avec
              des configurations différentes. Cet article va vous détailler une
              façon simple mais efficace de gérer ces différences.
            </p>
          </div>
          <div class="sect1">
            <h2 id="multiples-fichiers-plist">
              Multiples fichiers <code>plist</code>
            </h2>
            <div class="sectionbody">
              <div class="paragraph">
                <p>
                  Les fichiers <code>plist</code> sont des fichiers XML de
                  configuration pour XCode. Lors de la création d&#8217;un
                  projet dans Firebase, il est possible de récupérer une version
                  générée contenant les bonnes variables pour votre projet. Le
                  problème qui peut se produire est lorsqu&#8217;on génère
                  plusieurs livrables avec des configurations qui doivent être
                  différentes grace aux <em>target</em>. Il n&#8217;est pas
                  possible, ni confortable, de gérer le cas de plusieurs
                  fichiers <code>plist</code> dans les sources. La redéfinition
                  du nom du fichier à faire utiliser par Firebase ne marche pas
                  à tous les coups et il a tendance à aller lire la valeur par
                  défaut <code>GoogleService-Info.plist</code>.
                </p>
              </div>
              <div class="paragraph">
                <p>
                  L&#8217;idée est donc d&#8217;utiliser un script au build qui
                  se chargera de configurer correctement le fichier
                  <code>plist</code> qui sera inclu dans le livrable.
                </p>
              </div>
            </div>
          </div>
          <div class="sect1">
            <h2 id="première-étape-variabilisation">
              Première étape : variabilisation
            </h2>
            <div class="sectionbody">
              <div class="paragraph">
                <p>
                  Pour être capable de générer le fichier
                  <code>plist</code> correctement, il est nécessaire de le
                  variabiliser. Dans mon cas, j&#8217;ai identifié les valeurs
                  suivantes qui devaient être variabilisées:
                </p>
              </div>
              <div class="ulist">
                <ul>
                  <li>
                    <p>GOOGLE_APP_ID</p>
                  </li>
                  <li>
                    <p>BUNDLE_ID</p>
                  </li>
                  <li>
                    <p>CLIENT_ID</p>
                  </li>
                  <li>
                    <p>REVERSED_CLIENT_ID</p>
                  </li>
                </ul>
              </div>
              <div class="paragraph">
                <p>
                  J&#8217;ai donc ajouté des variables à la configuration de mon
                  build pour représenter ces valeurs qui doivent être
                  personnalisées. J&#8217;utilise des fichiers
                  <code>.xcconfig</code> mais ceci fonctionne également avec
                  l&#8217;ajout manuel (dans
                  <code
                    >Build Settings &gt; + &gt; Add User-Defined settings</code
                  >)
                </p>
              </div>
              <div class="paragraph">
                <p>
                  Unresolved directive in 2018-03-16-FirebasePListXCode.adoc -
                  include::site/static/lightbox.adoc[]
                </p>
              </div>
              <div class="paragraph">
                <p>
                  En plus de ça, j&#8217;ai modifié le fichier
                  <code>GoogleService-Info.plist</code> téléchargé sur Firebase
                  pour enlever les éléments qui allaient être remplacés à terme.
                  Plus exactement, j&#8217;ai remplacé les valeurs par des
                  chaînes du type <code>WILL BE REPLACED AT BUILD TIME</code>,
                  qui me permettent facilement de me rendre compte d&#8217;un
                  oubli de configuration.
                </p>
              </div>
            </div>
          </div>
          <div class="sect1">
            <h2 id="deuxième-étape-génération-du-fichier">
              Deuxième étape : génération du fichier
            </h2>
            <div class="sectionbody">
              <div class="paragraph">
                <p>
                  Une fois le fichier et l&#8217;environnement préparé, il ne
                  reste qu&#8217;à générer la version finale. Pour se faire, je
                  me base sur le système de <em>build</em> de XCode qui permet
                  de définir simplement des étapes. Les variables définies dans
                  la configuration du projet sont en effet disponibles
                  simplement lors de l&#8217;exécution des étapes de
                  <em>build</em>. En utilisant l&#8217;outil
                  <code>defaults</code> inclu dans macOS pour la manipulation
                  des fichiers <code>plist</code>, il est donc facile de définir
                  les valeurs attendues dans le fichier. J&#8217;ai ainsi
                  rajouté une étape <em>shell</em> script correspondant à ceci
                  dans le processus de <em>build</em>.
                </p>
              </div>
              <div class="listingblock">
                <div class="content">
                  <pre
                    class="highlight"
                  ><code class="language-shell" data-lang="shell">defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" GOOGLE_APP_ID ${GOOGLE_APP_ID}
defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" BUNDLE_ID ${PKG_IDENTIFIER}
defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" CLIENT_ID ${CLIENT_ID}
defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" REVERSED_CLIENT_ID ${REVERSED_CLIENT_ID}</code></pre>
                </div>
              </div>
              <div class="paragraph">
                <p>
                  Enfin, il faut ordonner cette étape de <em>build</em> après
                  celle de copie des ressources, pour effectuer la modification
                  uniquement dans le fichier binaire de l&#8217;application et
                  non dans les sources du projet.
                </p>
              </div>
            </div>
          </div>
          <div class="sect1">
            <h2 id="bénéfices">Bénéfices</h2>
            <div class="sectionbody">
              <div class="paragraph">
                <p>
                  Il est donc facile de disposer de configuration différente de
                  Firebase entre le <em>debug</em> et la <em>release</em> par
                  exemple. Ainsi vous pouvez tester l&#8217;envoi de
                  notification, par exemple, sans risquer de polluer des
                  utilisateurs de production, ou activer le
                  <em>crash reporting</em> uniquement en production par exemple.
                </p>
              </div>
            </div>
          </div>
          <footer class="entry-meta">
            <span class="entry-tags"
              ><a
                href="http://www.bloggure.info/tags/#XCode"
                title="Pages tagged XCode"
                class="tag"
                ><span class="term">XCode</span></a
              ><a
                href="http://www.bloggure.info/tags/#Firebase"
                title="Pages tagged Firebase"
                class="tag"
                ><span class="term">Firebase</span></a
              ></span
            >

            <div class="social-share">
              <ul class="socialcount socialcount-small inline-list">
                <li class="facebook">
                  <a
                    href="https://www.facebook.com/sharer/sharer.php?u=http://www.bloggure.info/FirebasePListXCode"
                    title="Share on Facebook"
                    ><span class="count"
                      ><i class="fa fa-facebook-square"></i> Like</span
                    ></a
                  >
                </li>
                <li class="twitter">
                  <a
                    href="https://twitter.com/intent/tweet?text=http://www.bloggure.info/FirebasePListXCode"
                    title="Share on Twitter"
                    ><span class="count"
                      ><i class="fa fa-twitter-square"></i> Tweet</span
                    ></a
                  >
                </li>
              </ul>
            </div>
            <!-- /.social-share -->
          </footer>
        </div>
        <!-- /.entry-content -->
        <section id="disqus_thread"></section>
        <!-- /#disqus_thread -->
        <div class="read-more">
          <div class="read-more-header">
            <a
              href="http://www.bloggure.info/JenkinsWorkflow"
              class="read-more-btn"
              >Read More</a
            >
          </div>
          <!-- /.read-more-header -->
          <div class="read-more-content">
            <h3>
              <a
                href="http://www.bloggure.info/Tuist_build_test_schemes"
                title="Tuist build test schemes"
                >Tuist build test schemes</a
              >
            </h3>
            <p>
              Tuist build test schemesI use tuist to build most of my iOS
              projects nowadays. And like every good software engineer I test
              the code that...&hellip;
              <a href="http://www.bloggure.info/Tuist_build_test_schemes"
                >Continue reading</a
              >
            </p>
          </div>
          <!-- /.read-more-content -->

          <div class="read-more-list">
            <div class="list-item">
              <h4>
                <a
                  href="http://www.bloggure.info/Module_Registration_Swift"
                  title="Swift module registration"
                  >Swift module registration</a
                >
              </h4>
              <span>Published on April 28, 2025</span>
            </div>
            <!-- /.list-item -->

            <div class="list-item">
              <h4>
                <a
                  href="http://www.bloggure.info/Swift_VisibleForTesting_Macro"
                  title="Swift macro : @VisibleForTesting"
                  >Swift macro : @VisibleForTesting</a
                >
              </h4>
              <span>Published on April 19, 2024</span>
            </div>
            <!-- /.list-item -->
          </div>
          <!-- /.read-more-list -->
        </div>
        <!-- /.read-more -->
      </article>
    </div>
    <!-- /#main -->

    <div class="footer-wrapper">
      <footer role="contentinfo">
        <span
          >&copy; 2026 . Powered by
          <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using a theme
          based on
          <a
            href="https://mademistakes.com/work/hpstr-jekyll-theme/"
            rel="nofollow"
            >HPSTR</a
          >.</span
        >
      </footer>
    </div>
    <!-- /.footer-wrapper -->

    <script>
      (function () {
        function loadScript(src) {
          return new Promise(function (resolve, reject) {
            var script = document.createElement("script");
            script.src = src;
            script.defer = true;
            script.async = false;
            script.onload = resolve;
            script.onerror = reject;
            document.head.appendChild(script);
          });
        }

        var jqCdn =
          "//ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js";
        var jqLocal =
          "http://www.bloggure.info/assets/js/vendor/jquery-3.7.1.min.js";
        var needFitVids = document.querySelector(
          "article iframe, article video"
        );
        var needMagnific = document.querySelector(
          'a[href$=".jpg" i],a[href$=".jpeg" i],a[href$=".png" i],a[href$=".gif" i]'
        );

        var jqPromise = loadScript(jqCdn)
          .catch(function () {
            return loadScript(jqLocal);
          })
          .then(function () {
            if (!window.jQuery) {
              return loadScript(jqLocal);
            }
          });

        jqPromise
          .then(function () {
            var chain = Promise.resolve();

            if (needFitVids) {
              chain = chain.then(function () {
                return loadScript(
                  "http://www.bloggure.info/assets/js/plugins/jquery.fitvids.js"
                );
              });
            }
            if (needMagnific) {
              chain = chain.then(function () {
                return loadScript(
                  "http://www.bloggure.info/assets/js/plugins/jquery.magnific-popup.js"
                );
              });
            }

            return chain;
          })
          .then(function () {
            return loadScript(
              "http://www.bloggure.info/assets/js/scripts.min.js"
            );
          });
      })();
    </script>

    <!-- Asynchronous Google Analytics snippet -->
    <script>
      (function (i, s, o, g, r, a, m) {
        i["GoogleAnalyticsObject"] = r;
        (i[r] =
          i[r] ||
          function () {
            (i[r].q = i[r].q || []).push(arguments);
          }),
          (i[r].l = 1 * new Date());
        (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(
        window,
        document,
        "script",
        "//www.google-analytics.com/analytics.js",
        "ga"
      );

      ga("create", "UA-11718843-3", "auto");
      ga("require", "linkid", "linkid.js");
      ga("send", "pageview");
    </script>

    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = "thereisnoplacelike1"; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var dsq = document.createElement("script");
        dsq.type = "text/javascript";
        dsq.async = true;
        dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
        (
          document.getElementsByTagName("head")[0] ||
          document.getElementsByTagName("body")[0]
        ).appendChild(dsq);
      })();

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var s = document.createElement("script");
        s.async = true;
        s.type = "text/javascript";
        s.src = "//" + disqus_shortname + ".disqus.com/count.js";
        (
          document.getElementsByTagName("HEAD")[0] ||
          document.getElementsByTagName("BODY")[0]
        ).appendChild(s);
      })();
    </script>
    <noscript
      >Please enable JavaScript to view the
      <a href="http://disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >
    <a href="http://disqus.com" class="dsq-brlink"
      >comments powered by <span class="logo-disqus">Disqus</span></a
    >
  </body>
</html>
