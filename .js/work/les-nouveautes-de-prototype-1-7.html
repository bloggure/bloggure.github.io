<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>Prototype 1.7 new features &#8211; Bloggure</title>
    <meta
      name="description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta name="keywords" content="" />

    <!-- Open Graph -->
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="Prototype 1.7 new features" />
    <meta
      property="og:description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta
      property="og:url"
      content="http://www.bloggure.info/.js/work/les-nouveautes-de-prototype-1-7"
    />
    <meta property="og:site_name" content="Bloggure" />

    <link
      rel="canonical"
      href="http://www.bloggure.info/.js/work/les-nouveautes-de-prototype-1-7"
    />
    <link
      href="http://www.bloggure.info/feed.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Bloggure Feed"
    />

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- For all browsers -->
    <link
      rel="stylesheet"
      href="http://www.bloggure.info/assets/css/main.css"
    />
    <!-- Webfonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic"
      rel="stylesheet"
      type="text/css"
    />

    <meta http-equiv="cleartype" content="on" />

    <!-- Load Modernizr -->
    <script src="http://www.bloggure.info/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

    <!-- Icons -->
    <!-- 16x16 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.ico" />
    <!-- 32x32 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.png" />
    <!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
    <link
      rel="apple-touch-icon-precomposed"
      href="http://www.bloggure.info/images/apple-touch-icon-precomposed.png"
    />
    <!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="72x72"
      href="http://www.bloggure.info/images/apple-touch-icon-72x72-precomposed.png"
    />
    <!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="114x114"
      href="http://www.bloggure.info/images/apple-touch-icon-114x114-precomposed.png"
    />
    <!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="144x144"
      href="http://www.bloggure.info/images/apple-touch-icon-144x144-precomposed.png"
    />
  </head>

  <body id="post">
    <!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

    <div class="entry-header">
      <header class="header-title">
        <div class="header-title-wrap">
          <h1 class="entry-title" itemprop="name">
            <a href="http://www.bloggure.info/">Bloggure</a>
          </h1>
        </div>
        <!-- /.header-title-wrap -->
      </header>
    </div>

    <div id="main" role="main">
      <article class="hentry">
        <div class="entry-content">
          <header>
            <div class="entry-meta">
              <span class="entry-date date published updated"
                ><time
                  datetime="2010-11-20T00:00:00+01:00"
                  itemprop="datePublished"
                  ><a
                    href="http://www.bloggure.info/.js/work/les-nouveautes-de-prototype-1-7"
                    >November 20, 2010</a
                  ></time
                ></span
              ><span
                class="author vcard"
                itemprop="author"
                itemscope
                itemtype="http://schema.org/Person"
                ><span itemprop="name" class="fn"
                  ><a
                    href="http://www.bloggure.info/tdebarochez"
                    title="About tdebarochez"
                    itemprop="url"
                    >tdebarochez</a
                  ></span
                ></span
              >&nbsp; &bull; &nbsp;<span class="entry-comments"
                ><a
                  href="http://www.bloggure.info/.js/work/les-nouveautes-de-prototype-1-7#disqus_thread"
                  >Comment</a
                ></span
              >
            </div>
            <!-- /.entry-meta -->

            <h1 class="entry-title" itemprop="name">
              <a
                href="http://www.bloggure.info/.js/work/les-nouveautes-de-prototype-1-7"
                rel="bookmark"
                title="Prototype 1.7 new features"
                itemprop="url"
                >Prototype 1.7 new features</a
              >
            </h1>
          </header>
          <!--:en--><em
            >This blog post has not been translated, please find below the
            french version</em
          >

          <br /><strong>Màj : </strong>Voici
          <a href="http://prototypejs.org/2010/11/22/prototype-1-7"
            >l'annonce officielle</a
          ><br />
          <h2>Introduction</h2>
          Alors que la version 1.7 de
          <a href="http://prototypejs.org">Prototype</a>, le fameux framework
          JS, s'apprête à voir le jour. Nous allons, dans cet article, lister
          trois nouveautés majeures de cette version.
          <h1>Element.Layout</h1>
          Cette classe permet de fournir, avec un maximum de précision, tout un
          tas de mesures sur un élement. Il existe deux manières d'utiliser
          cette classe, voici la méthode du fainéant :
          <figure class="highlight">
            <pre><code class="language-js" data-lang="js"><span></span><span class="nx">$</span><span class="p">(</span><span class="s1">&#39;elt&#39;</span><span class="p">).</span><span class="nx">measure</span><span class="p">(</span><span class="s1">&#39;margin-top&#39;</span><span class="p">);</span> <span class="c1">// -&amp;gt; retourne la marge haute en pixel de elt</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;elt&#39;</span><span class="p">).</span><span class="nx">measure</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">);</span> <span class="c1">// -&amp;gt; retourne la hauteur en pixel de elt</span></code></pre>
          </figure>
          Le fonctionnement de la deuxième ligne est similaire à l'utilisation
          de la méthode
          <a href="http://api.prototypejs.org/dom/Element/prototype/getHeight/"
            >Element#getHeight()</a
          >. Une utilisation plus minutieuse pourrait ressembler à ça ;
          <figure class="highlight">
            <pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">layout</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;elt&#39;</span><span class="p">).</span><span class="nx">getLayout</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="nx">layout</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;margin-top&#39;</span><span class="p">);</span> <span class="c1">// retourne la même hauteur que précédemment.</span>
<span class="nx">layout</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;height&#39;</span><span class="p">);</span> <span class="c1">// retourne la même hauteur que précédemment.</span></code></pre>
          </figure>
          L'avantage de la seconde méthode est que les valeurs de base
          nécessaire au calcul des dimensions sont mises en cache dans la
          variable layout et donc un seul appel est fait au DOM (gourmand en
          ressource). Le paramètre "<em>true</em>" de
          <a href="http://api.prototypejs.org/dom/Element/prototype/getLayout/"
            >Element#getLayout()</a
          >
          permet de forcer la récupération de toutes les valeurs d'un seul coup.
          Si ce paramètre est homis, les valeurs seront récupérées une par une
          et conservées en cache. Pour des raisons d'optimisation, les anciennes
          méthodes
          <a href="http://api.prototypejs.org/dom/Element/prototype/getWidth/"
            >Element#getWidth()</a
          >
          et
          <a href="http://api.prototypejs.org/dom/Element/prototype/getHeight/"
            >Element#getHeight()</a
          >
          n'utilisent malheureusement pas cette méthode, mais utilisent
          l'ancienne méthode
          <a
            href="http://api.prototypejs.org/dom/Element/prototype/getDimensions/"
            >Element#getDimensions()</a
          >. La liste des propriétés mesurables est disponible à
          <a href="http://api.prototypejs.org/dom/Element/Layout/"
            >cette adresse</a
          >. Note 1 : Il faut bien garder à l'esprit que si les dimensions de
          l'élément, auquel votre layout fais référence, change, vous devrez
          créer un nouvelle instance de
          <a href="http://api.prototypejs.org/dom/Element/Layout/"
            >Element.Layout</a
          >. Note 2 : Si votre élément est masqué avec style
          "<em>diplay:none</em>" il vous sera possible d'effectuer des mesures
          uniquement si l'élément parent est visible. Par ailleurs les mesures
          <em>width</em>, <em>height</em>, <em>top</em>, <em>left</em>,
          <em>bottom</em> et <em>right</em> auront toujours pour valeur 0.
          <h1>Event.Handler</h1>
          L'un des problèmes de la délégation d'évènement avec les anciennes
          méthodes d'observation d'évènement est le ciblage de l'élement qui
          nous intéresse. Considérons pour les exemples suivant l'arbre HTML
          ci-dessous :
          <figure class="highlight">
            <pre><code class="language-html" data-lang="html"><span></span><span class="p">&lt;</span><span class="nt">ul</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;elt&quot;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;foo&quot;</span> <span class="na">data-code</span><span class="o">=</span><span class="s">&quot;un&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:void(0);&quot;</span><span class="p">&gt;</span>un<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;foo&quot;</span> <span class="na">data-code</span><span class="o">=</span><span class="s">&quot;deux&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:void(0);&quot;</span><span class="p">&gt;</span>deux<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">li</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;foo&quot;</span> <span class="na">data-code</span><span class="o">=</span><span class="s">&quot;trois&quot;</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;javascript:void(0);&quot;</span><span class="p">&gt;</span>trois<span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;&lt;/</span><span class="nt">li</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">ul</span><span class="p">&gt;</span></code></pre>
          </figure>
          Lorsque qu'un évènement est levé sur un élément il est levé sur tous
          ses parents récursivement, tant qu'il n'est pas arrêté explicitement
          ou qu'il a atteind la racine de l'arbre. On devait précédemment faire
          ce genre de chose :
          <figure class="highlight">
            <pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">listener</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">findElement</span><span class="p">(</span><span class="s1">&#39;.foo&#39;</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">Object</span><span class="p">.</span><span class="nx">isElement</span><span class="p">(</span><span class="nx">target</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="p">...</span> <span class="c1">// traitement avec target, élement qui nous intéresse</span>
<span class="p">}</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;elt&#39;</span><span class="p">).</span><span class="nx">observe</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span>
<span class="p">...</span> <span class="c1">// et au besoin :</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;elt&#39;</span><span class="p">).</span><span class="nx">stopObserving</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="nx">listener</span><span class="p">);</span></code></pre>
          </figure>
          Quand nous devions arrêter l'observation d'un évènement particulier il
          était fastidieux de devoir stocker la fonction assignée dans une
          variable bien précise afin de pouvoir la re-passer en paramètre à la
          méthode
          <a
            href="http://api.prototypejs.org/dom/Element/prototype/stopObserving/"
            >Element#stopObserving()</a
          >. Heureusement les développeurs de Prototype nous ont simplifié la
          tache avec la méthode
          <a href="http://api.prototypejs.org/dom/Element/prototype/on/"
            >Element#on()</a
          >. Cette nouvelle méthode prend en paramètre un nouveau paramètre (un
          selecteur CSS) permettant de cibler exactement la cible qui nous
          intéresse. De plus elle renvoie une instance de
          <a href="http://api.prototypejs.org/dom/Event/Handler/"
            >Element.Handler</a
          >
          qui possède des méthodes <a
            href="http://api.prototypejs.org/dom/Event/Handler/prototype/stop/"
            >stop()</a
          >
          et
          <a
            href="http://api.prototypejs.org/dom/Event/Handler/prototype/start/"
            >start()</a
          >
          qui permettent respectivement d'arrêter et de reprendre l'observation
          d'un évènement particulier. En voici un exemple d'utilisation :
          <figure class="highlight">
            <pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">handler</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="s1">&#39;elt&#39;</span><span class="p">).</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;click&#39;</span><span class="p">,</span> <span class="s1">&#39;.foo&#39;</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">,</span> <span class="nx">target</span><span class="p">)</span> <span class="p">{</span>
  <span class="p">...</span> <span class="c1">// traitement avec target, élement qui nous intéresse</span>
<span class="p">});</span>
<span class="p">...</span> <span class="c1">// et au besoin :</span>
<span class="nx">handler</span><span class="p">.</span><span class="nx">stop</span><span class="p">();</span>
<span class="p">...</span> <span class="c1">// et de nouveau :</span>
<span class="nx">handler</span><span class="p">.</span><span class="nx">start</span><span class="p">();</span></code></pre>
          </figure>
          Pour compléter ces améliorations, une nouvelle méthode a été ajouté :
          <a href="http://api.prototypejs.org/dom/Element/prototype/purge/"
            >Element#purge()</a
          >
          permettant de nettoyer un élément de tous les listeners d'évenement
          qui lui sont attachés.
          <h1>Sizzle</h1>
          <a href="http://sizzlejs.com/">Sizzle</a> est le nom du sélecteur CSS
          utilisé dans <a href="http://jquery.com/">jQuery</a>. Afin de pouvoir
          utiliser ce middleware partagé entre plusieurs frameworks, l'équipe de
          développement a fait un gros travail de modularité pour laisser le
          choix du moteur du traitement CSS. En effet, si vous souhaitez par
          exemple utiliser l'ancien moteur (présent depuis la version 1.5.1), il
          vous suffit de rapatrier le code source (via
          <a href="https://github.com/sstephenson/prototype">github</a> par
          exemple) et compiler prototype de la manière suivante :
          <pre class="brush: shell;">
rake dist SELECTOR_ENGINE=legacy_selector</pre
          >
          De la même manière vous pouvez écrire votre propre moteur en le
          plaçant dans le répertoire vendor/ du package.
          <h2>Conclusion</h2>
          Les trois améliorations de la nouvelle mouture énoncées ci-dessus
          peuvent-être complétées par une ribambelle d'ajustements (notamment
          lié à IE9). Cette nouvelle version confirme les prétentions de la
          librairie visant à palier les manquements de compatibilités
          inter-navigateurs et simplifier considérablement le développement
          d'applications javascript, tout en restant le plus léger possible.<!--:-->
          <footer class="entry-meta">
            <span class="entry-tags"></span>

            <div class="social-share">
              <ul class="socialcount socialcount-small inline-list">
                <li class="facebook">
                  <a
                    href="https://www.facebook.com/sharer/sharer.php?u=http://www.bloggure.info/.js/work/les-nouveautes-de-prototype-1-7"
                    title="Share on Facebook"
                    ><span class="count"
                      ><i class="fa fa-facebook-square"></i> Like</span
                    ></a
                  >
                </li>
                <li class="twitter">
                  <a
                    href="https://twitter.com/intent/tweet?text=http://www.bloggure.info/.js/work/les-nouveautes-de-prototype-1-7"
                    title="Share on Twitter"
                    ><span class="count"
                      ><i class="fa fa-twitter-square"></i> Tweet</span
                    ></a
                  >
                </li>
              </ul>
            </div>
            <!-- /.social-share -->
          </footer>
        </div>
        <!-- /.entry-content -->
        <section id="disqus_thread"></section>
        <!-- /#disqus_thread -->
        <div class="read-more">
          <div class="read-more-header">
            <a
              href="http://www.bloggure.info/shelf/so-i-made-it"
              class="read-more-btn"
              >Read More</a
            >
          </div>
          <!-- /.read-more-header -->
          <div class="read-more-content">
            <h3>
              <a
                href="http://www.bloggure.info/SwiftUI-UIKit_Interop"
                title="SwiftUI UIKit Interop"
                >SwiftUI UIKit Interop</a
              >
            </h3>
            <p>
              Now that iOS13 is available for more than year, we can start to
              set it as a lower bound for our deployments.This allows us to play
              with a...&hellip;
              <a href="http://www.bloggure.info/SwiftUI-UIKit_Interop"
                >Continue reading</a
              >
            </p>
          </div>
          <!-- /.read-more-content -->

          <div class="read-more-list">
            <div class="list-item">
              <h4>
                <a
                  href="http://www.bloggure.info/XCodeUnitTestInheritance"
                  title="XCode unit test and inheritance"
                  >XCode unit test and inheritance</a
                >
              </h4>
              <span>Published on December 02, 2020</span>
            </div>
            <!-- /.list-item -->

            <div class="list-item">
              <h4>
                <a
                  href="http://www.bloggure.info/Revival"
                  title="Bloggure revival"
                  >Bloggure revival</a
                >
              </h4>
              <span>Published on December 01, 2020</span>
            </div>
            <!-- /.list-item -->
          </div>
          <!-- /.read-more-list -->
        </div>
        <!-- /.read-more -->
      </article>
    </div>
    <!-- /#main -->

    <div class="footer-wrapper">
      <footer role="contentinfo">
        <span
          >&copy; 2020 . Powered by
          <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using a theme
          based on
          <a
            href="https://mademistakes.com/work/hpstr-jekyll-theme/"
            rel="nofollow"
            >HPSTR</a
          >.</span
        >
      </footer>
    </div>
    <!-- /.footer-wrapper -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
      window.jQuery ||
        document.write(
          '<script src="http://www.bloggure.info/assets/js/vendor/jquery-1.9.1.min.js"><\/script>'
        );
    </script>
    <script src="http://www.bloggure.info/assets/js/scripts.min.js"></script>

    <!-- Asynchronous Google Analytics snippet -->
    <script>
      (function (i, s, o, g, r, a, m) {
        i["GoogleAnalyticsObject"] = r;
        (i[r] =
          i[r] ||
          function () {
            (i[r].q = i[r].q || []).push(arguments);
          }),
          (i[r].l = 1 * new Date());
        (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(
        window,
        document,
        "script",
        "//www.google-analytics.com/analytics.js",
        "ga"
      );

      ga("create", "UA-11718843-3", "auto");
      ga("require", "linkid", "linkid.js");
      ga("send", "pageview");
    </script>

    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = "thereisnoplacelike1"; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var dsq = document.createElement("script");
        dsq.type = "text/javascript";
        dsq.async = true;
        dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
        (
          document.getElementsByTagName("head")[0] ||
          document.getElementsByTagName("body")[0]
        ).appendChild(dsq);
      })();

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var s = document.createElement("script");
        s.async = true;
        s.type = "text/javascript";
        s.src = "//" + disqus_shortname + ".disqus.com/count.js";
        (
          document.getElementsByTagName("HEAD")[0] ||
          document.getElementsByTagName("BODY")[0]
        ).appendChild(s);
      })();
    </script>
    <noscript
      >Please enable JavaScript to view the
      <a href="http://disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >
    <a href="http://disqus.com" class="dsq-brlink"
      >comments powered by <span class="logo-disqus">Disqus</span></a
    >
  </body>
</html>
