<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Bloggure</title>
<meta name="description" content="Multi author blog about programming, computing and geek stuff">




<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Bloggure">
<meta property="og:description" content="Multi author blog about programming, computing and geek stuff">
<meta property="og:url" content="http://www.bloggure.info/page2/">
<meta property="og:site_name" content="Bloggure">





<link rel="canonical" href="http://www.bloggure.info/page2/">
<link href="http://www.bloggure.info/feed.xml" type="application/atom+xml" rel="alternate" title="Bloggure Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://www.bloggure.info/assets/css/main.css">
<!-- Webfonts -->
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<!-- Load Modernizr -->
<script src="http://www.bloggure.info/assets/js/vendor/modernizr-3.12.0.min.js"></script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://www.bloggure.info/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://www.bloggure.info/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://www.bloggure.info/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://www.bloggure.info/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://www.bloggure.info/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.bloggure.info/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post-index" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<div class="entry-header">
  
  
  <div class="header-title">
    <div class="header-title-wrap">
      <h1 itemprop="name"><a href="http://www.bloggure.info/">Bloggure</a></h1>
      <h2><a href="/page2/"></a></h2>
    </div><!-- /.header-title-wrap -->
  </div><!-- /.header-title -->
</div><!-- /.entry-header -->

<div id="main" role="main">
  

<article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2020-12-06T00:00:00+01:00" itemprop="datePublished"><a href="http://www.bloggure.info/mac-checklist">December 06, 2020</a></time></span><span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="http://www.bloggure.info/cgatay" title="About cgatay" itemprop="url">cgatay</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://www.bloggure.info/mac-checklist#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title" itemprop="name"><a href="http://www.bloggure.info/mac-checklist" rel="bookmark" title="macOS tools checklist" itemprop="url">macOS tools checklist</a></h1>
    
  </header>
  <div class="entry-content" itemprop="description">
    <h1 id="welcome-to-the-mac-world">Welcome to the mac world</h1>

<p>Wether you‚Äôre new to macOS or an user coming from different machines, the tools we tend to use is very important to be productive.</p>

<p>Here you‚Äôll find my list and what I install on a fresh machine to get started.</p>

<h2 id="system-tools">System tools</h2>

<p>First and foremost, I start with <a href="https://brew.sh"><code>brew</code></a> to handle all my packages, but instead of doing so manually, I use my <a href="https://github.com/CedricGatay/dotfiles.git"><code>dotfiles</code></a> and my ‚Äúmagic‚Äù
install script that does all the heavy lifting for me.</p>

<h2 id="keyboard-tools">Keyboard tools</h2>

<p>I use a TypeMatrix with a Colemak layout and also the internal keyboard of my laptop with its default layout.
Colemak layout is available on a fresh macOS install but it is far from perfect as there are a lot of missing dead keys 
(to type accented letters mainly), so I start by installing the layout provided on this page: <a href="https://colemak.com/Mac">Colemak mac</a></p>

<p>To easily switch between the two and get almost the same feeling, I use <a href="http://karabiner-elements.pqrs.org/">Karabiner Elements</a>.</p>

<h2 id="everyday-tools">Everyday tools</h2>

<ul>
  <li><a href="https://sdkman.io">sdkman</a>: to manage installation of various sdk (mainly Java based)</li>
  <li><a href="https://iterm2.com">iTerm</a>: nice terminal app with profiles</li>
  <li><a href="https://github.com/tmux/tmux/wiki">tmux</a>: multi terminal in one window, switching terminal with a keystroke</li>
  <li><a href="https://www.zsh.org">zsh</a>: Z-Shell</li>
  <li><a href="https://starship.rs">starship</a>: fast shell prompt</li>
  <li><a href="https://github.com/BurntSushi/ripgrep">ripgrep</a>: faster <code>grep</code></li>
  <li><a href="https://github.com/sharkdp/bat">bat</a>: nice <code>cat</code> alternative (with paging / highlighting)</li>
  <li><a href="https://github.com/ogham/exa">exa</a>: replacement for <code>ls</code></li>
  <li><a href="https://www.alfredapp.com">Alfred</a>: Spotlight with more features, this is my main app launcher / switcher</li>
  <li><a href="https://go.setapp.com/invite/cgatay">SetApp</a>: App subscription service, use many tools from this (BetterTouchTool, iStat, BarTender‚Ä¶)</li>
</ul>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2020-12-03T00:00:00+01:00" itemprop="datePublished"><a href="http://www.bloggure.info/SwiftUI-UIKit_Interop">December 03, 2020</a></time></span><span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="http://www.bloggure.info/cgatay" title="About cgatay" itemprop="url">cgatay</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://www.bloggure.info/SwiftUI-UIKit_Interop#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title" itemprop="name"><a href="http://www.bloggure.info/SwiftUI-UIKit_Interop" rel="bookmark" title="SwiftUI UIKit Interop" itemprop="url">SwiftUI UIKit Interop</a></h1>
    
  </header>
  <div class="entry-content" itemprop="description">
    <p>Now that iOS13 is available for more than year, we can start to set it as a lower bound for our deployments.</p>

<p>This allows us to play with all sugar that Apple put in it, one of the biggest thing is the arrival of SwiftUI to supercede UIKit (write cross platform UIs and so on).</p>

<h2 id="bridging-the-two-worlds">Bridging the two worlds</h2>

<h3 id="using-swiftui-from-uikit">Using SwiftUI from UIKit</h3>

<p>The first thing we might try to do, is embedding a SwiftUI View inside our <code>UIViewController</code> based application. To do so, Apple gives us <code>UIHostingViewController</code> which is a simple bridging controller, straightforward to use.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">struct</span> <span class="kt">MyNewView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">view</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
        <span class="kt">Text</span><span class="p">(</span><span class="s">"I'm in SwiftUI"</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">class</span> <span class="kt">MyNewViewViewController</span><span class="p">:</span> <span class="kt">UIHostingViewController</span> <span class="p">{</span>
    <span class="nf">init</span><span class="p">(){</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">init</span><span class="p">(</span><span class="nv">rootView</span><span class="p">:</span> <span class="kt">MyNewView</span><span class="p">())</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h3 id="uiviewcontroller-in-swiftui">UIViewController in SwiftUI</h3>

<p>However, at times we still need to reuse our good old <code>UIViewController</code>, either because we can not afford a full SwiftUI rewrite, so we want to keep old code and migrate pieces by pieces or because we are using something not yet adapted to SwiftUI.</p>

<p>In my case it was using the camera to scan a QRCode.</p>

<h4 id="non-elegant-solution">Non elegant solution</h4>

<p>I faced a few issue with examples I found out, most of them are adding an extension to the <code>UIViewController</code> that makes it conform to <code>UIViewControllerRepresentable</code>.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">class</span> <span class="kt">MyViewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">{</span>
    <span class="k">var</span> <span class="nv">cancellable</span><span class="p">:</span> <span class="kt">Cancellable</span><span class="p">?</span>
    <span class="c1">// classic stuff</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">MyViewController</span><span class="p">:</span> <span class="kt">UIViewControllerRepresentable</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">UIViewControllerType</span> <span class="o">=</span> <span class="kt">MyViewController</span>

    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">makeUIViewController</span><span class="p">(</span><span class="n">context</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">UIViewControllerRepresentableContext</span><span class="o">&lt;</span><span class="kt">MyViewController</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerType</span> <span class="p">{</span>
        <span class="k">self</span> <span class="c1">// don't .init() please, class instance is already available</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">updateUIViewController</span><span class="p">(</span><span class="nv">_</span><span class="p">:</span> <span class="kt">UIViewControllerType</span><span class="p">,</span> <span class="n">context</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">UIViewControllerRepresentableContext</span><span class="o">&lt;</span><span class="kt">MyViewController</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">dismantleUIViewController</span><span class="p">(</span><span class="n">_</span> <span class="nv">uiViewController</span><span class="p">:</span> <span class="kt">UIViewControllerType</span><span class="p">,</span> <span class="n">coordinator</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">Coordinator</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">uiViewController</span><span class="o">.</span><span class="n">cancellable</span><span class="p">?</span><span class="o">.</span><span class="nf">cancel</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">MyView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">MyViewController</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>I find this not easy to read, as we‚Äôre doing weird thing by returning  <code>self</code> from a function named <code>makeUIViewController</code>.
Some example are telling to return <code>MyViewController()</code> instead of <code>self</code>. Please don‚Äôt do this otherwise you‚Äôre creating the <code>UIViewController</code> twice for each call !</p>

<p>I also had a leak when using  <code>Combine</code> (more to come about this great framework), my  <code>Cancellable</code>s were never freed, leading in a memory cycle that kept the <code>UIViewController</code> living even though it was no longer presented.</p>

<p>It is important to do proper house keeping in the <code>dismantleUIViewController</code> method if you don‚Äôt want to use too much memory and slow down your app.</p>

<h4 id="nice-looking-way-of-doing">Nice looking way of doing</h4>

<p>You will find a working example below, basically we need to implement a <code>UIViewControllerRepresentable</code> struct to represent be the container for our <code>UIViewController</code> in the SwiftUI world.</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">class</span> <span class="kt">MyViewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">{</span>
    <span class="k">var</span> <span class="nv">cancellable</span><span class="p">:</span> <span class="kt">Cancellable</span><span class="p">?</span>
    <span class="c1">// classic stuff</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">MyGreatView</span><span class="p">:</span> <span class="kt">UIViewControllerRepresentable</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kd">typealias</span> <span class="kt">UIViewControllerType</span> <span class="o">=</span> <span class="kt">MyViewController</span>

    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">makeUIViewController</span><span class="p">(</span><span class="n">context</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">UIViewControllerRepresentableContext</span><span class="o">&lt;</span><span class="kt">MyGreatView</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">UIViewControllerType</span> <span class="p">{</span>
        <span class="kt">MyViewController</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kd">func</span> <span class="nf">updateUIViewController</span><span class="p">(</span><span class="nv">_</span><span class="p">:</span> <span class="kt">UIViewControllerType</span><span class="p">,</span> <span class="n">context</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">UIViewControllerRepresentableContext</span><span class="o">&lt;</span><span class="kt">MyGreatView</span><span class="o">&gt;</span><span class="p">)</span> <span class="p">{}</span>

    <span class="kd">static</span> <span class="kd">func</span> <span class="nf">dismantleUIViewController</span><span class="p">(</span><span class="n">_</span> <span class="nv">uiViewController</span><span class="p">:</span> <span class="kt">UIViewControllerType</span><span class="p">,</span> <span class="n">coordinator</span> <span class="nv">_</span><span class="p">:</span> <span class="kt">Coordinator</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">uiViewController</span><span class="o">.</span><span class="n">cancellable</span><span class="p">?</span><span class="o">.</span><span class="nf">cancel</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">struct</span> <span class="kt">MyView</span><span class="p">:</span> <span class="kt">View</span> <span class="p">{</span>
  <span class="k">var</span> <span class="nv">body</span><span class="p">:</span> <span class="kd">some</span> <span class="kt">View</span> <span class="p">{</span>
    <span class="kt">MyGreatView</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2020-12-02T00:00:00+01:00" itemprop="datePublished"><a href="http://www.bloggure.info/XCodeUnitTestInheritance">December 02, 2020</a></time></span><span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="http://www.bloggure.info/cgatay" title="About cgatay" itemprop="url">cgatay</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://www.bloggure.info/XCodeUnitTestInheritance#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title" itemprop="name"><a href="http://www.bloggure.info/XCodeUnitTestInheritance" rel="bookmark" title="XCode unit test and inheritance" itemprop="url">XCode unit test and inheritance</a></h1>
    
  </header>
  <div class="entry-content" itemprop="description">
    <p>As I was working on an iOS project, I added unit tests to ensure things are not behaving badly (and will not).</p>

<p>During the process, a common pattern showed up and a few fields were required, I came up with the idea to basically create a <code>BaseTest</code> for my tests, so that everything is unified.</p>

<h2 id="base-idea">Base idea</h2>

<p>I came up with something like the following for my tests</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">class</span> <span class="kt">BaseTest</span><span class="o">&lt;</span><span class="kt">T</span><span class="p">,</span> <span class="kt">Action</span><span class="o">&gt;</span><span class="p">:</span> <span class="kt">XCTestCase</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">subject</span><span class="p">:</span> <span class="kt">T</span><span class="o">!</span>
    <span class="k">var</span> <span class="nv">actions</span><span class="p">:</span> <span class="p">[</span><span class="kt">Action</span><span class="p">]</span><span class="o">!</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">(){</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="kt">T</span><span class="p">()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">LoginTest</span><span class="p">:</span> <span class="kt">BaseTest</span><span class="o">&lt;</span><span class="kt">LoginMiddleware</span><span class="p">,</span> <span class="kt">LoginAction</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">test_loginIsWorking</span><span class="p">(){</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>It worked very well within XCode, I could run the tests by hitting the üîπ in the gutter.</p>

<h2 id="bad-things-happen">Bad things happen</h2>

<p>The thing that I discovered later (thanks to the CI feedback), is that XCode was not properly discovering my tests as it should.
At first I blamed the fact that my new tests were not at the top level of my sources folder (and the other ones were), but it was easy to check that this was not the problem at all.</p>

<p>Then, I blamed <code>fastlane</code> and thought that I‚Äôve missed something in my test target configuration or something, but in fact, the problem was similar when using classical <code>CMD + U</code> key combo.</p>

<p>XCode was simply not discovering my test.</p>

<h2 id="workaround">Workaround</h2>
<p>Inheritance is often misused, in this case, I think it is relevant, but I applied classical way of working around this. I changed my <code>BaseTest</code> to a <code>BaseHelper</code> instead, to which the test delegates the calls.</p>

<p>With this, the test class properly inherits <code>XCTestCase</code> and is discovered as expected (even in subfolders).</p>

<figure class="highlight"><pre><code class="language-swift" data-lang="swift"><span class="kd">class</span> <span class="kt">BaseHelper</span><span class="o">&lt;</span><span class="kt">T</span><span class="p">,</span> <span class="kt">Action</span><span class="o">&gt;</span><span class="p">{</span>
    <span class="k">var</span> <span class="nv">subject</span><span class="p">:</span> <span class="kt">T</span><span class="o">!</span>
    <span class="k">var</span> <span class="nv">actions</span><span class="p">:</span> <span class="p">[</span><span class="kt">Action</span><span class="p">]</span><span class="o">!</span>

    <span class="nf">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">subject</span> <span class="o">=</span> <span class="kt">T</span><span class="p">()</span>
        <span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="kt">LoginTest</span><span class="p">:</span> <span class="kt">XCTestCase</span> <span class="p">{</span>
    <span class="k">var</span> <span class="nv">helper</span><span class="p">:</span> <span class="kt">BaseHelper</span><span class="o">&lt;</span><span class="kt">LoginMiddleware</span><span class="p">,</span> <span class="kt">LoginAction</span><span class="o">&gt;!</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">(){</span>
        <span class="n">helper</span> <span class="o">=</span> <span class="o">.</span><span class="nf">init</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="kd">func</span> <span class="nf">test_loginIsWorking</span><span class="p">(){</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>The nice thing in this solution is that the <code>setUp</code> call is no longer magical !</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2020-12-01T00:00:00+01:00" itemprop="datePublished"><a href="http://www.bloggure.info/Revival">December 01, 2020</a></time></span><span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="http://www.bloggure.info/cgatay" title="About cgatay" itemprop="url">cgatay</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://www.bloggure.info/Revival#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title" itemprop="name"><a href="http://www.bloggure.info/Revival" rel="bookmark" title="Bloggure revival" itemprop="url">Bloggure revival</a></h1>
    
  </header>
  <div class="entry-content" itemprop="description">
    <h1 id="its-been-a-long-time">It‚Äôs been a long time</h1>

<p>It‚Äôs been a very long time since last post (5 years‚Ä¶).</p>

<p>I am convinced that blogging is useful, at least for my present self, and for my future self that tends to lose track of important things.</p>

<h2 id="what-will-this-be-about-">What will this be about ?</h2>

<p>In the <em>past</em> I blogged a lot about Java / Maven and so on, my days have evolved to another languages, so I guess
there will be less JVM things (but may be a few Kotlin) and more Swift / Rust on the other end.</p>

<h2 id="technical-stack">Technical stack</h2>

<p>In a blog reboot, we (I mean dev) like to follow the latest trend and migrate our blog system to latest hype stack.
I will avoid this and focus on writing instead, so the site stays in its 15‚Äô shape:</p>

<ul>
  <li><a href="http://jekyllrb.com/">jekyll</a></li>
  <li><a href="https://pages.github.com">github-pages</a></li>
  <li>markdown (I think <code>jenkins-asciidoc</code> is around the corner though)</li>
  <li><a href="https://actions.github.com">github actions</a> for building</li>
</ul>

<p>The sole new thing is that I‚Äôm trying to write using <a href="https://gitpod.io">gitpod.io</a> to get a distraction free environment.</p>

  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<article class="hentry" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2018-03-13T00:00:00+01:00" itemprop="datePublished"><a href="http://www.bloggure.info/FirebasePListXCode">March 13, 2018</a></time></span><span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="http://www.bloggure.info/Cedric" title="About Cedric" itemprop="url">Cedric</a></span></span></div><!-- /.entry-meta -->
    
      <h1 class="entry-title" itemprop="name"><a href="http://www.bloggure.info/FirebasePListXCode" rel="bookmark" title="Firebase + XCode" itemprop="url">Firebase + XCode</a></h1>
    
  </header>
  <div class="entry-content" itemprop="description">
    <div class="paragraph">
<p>Il est courant maintenant d&#8217;utiliser Firebase dans les applications mobiles.
Que ce soit pour la partie statistiques, les notifications ou le reporting des <em>crashes</em>.
L&#8217;int√©gration est tr√®s facile, mais peut devenir compliqu√©e d√®s lors qu&#8217;on manipule des <em>target</em> diff√©rentes avec des configurations diff√©rentes.
Cet article va vous d√©tailler une fa√ßon simple mais efficace de g√©rer ces diff√©rences.</p>
</div>
<div class="sect1">
<h2 id="multiples-fichiers-plist">Multiples fichiers <code>plist</code></h2>
<div class="sectionbody">
<div class="paragraph">
<p>Les fichiers <code>plist</code> sont des fichiers XML de configuration pour XCode.
Lors de la cr√©ation d&#8217;un projet dans Firebase, il est possible de r√©cup√©rer une version g√©n√©r√©e contenant les bonnes variables pour votre projet.
Le probl√®me qui peut se produire est lorsqu&#8217;on g√©n√®re plusieurs livrables avec des configurations qui doivent √™tre diff√©rentes grace aux <em>target</em>.
Il n&#8217;est pas possible, ni confortable, de g√©rer le cas de plusieurs fichiers <code>plist</code> dans les sources.
La red√©finition du nom du fichier √† faire utiliser par Firebase ne marche pas √† tous les coups et il a tendance √† aller lire la valeur par d√©faut <code>GoogleService-Info.plist</code>.</p>
</div>
<div class="paragraph">
<p>L&#8217;id√©e est donc d&#8217;utiliser un script au build qui se chargera de configurer correctement le fichier <code>plist</code> qui sera inclu dans le livrable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="premi√®re-√©tape-variabilisation">Premi√®re √©tape : variabilisation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Pour √™tre capable de g√©n√©rer le fichier <code>plist</code> correctement, il est n√©cessaire de le variabiliser.
Dans mon cas, j&#8217;ai identifi√© les valeurs suivantes qui devaient √™tre variabilis√©es:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>GOOGLE_APP_ID</p>
</li>
<li>
<p>BUNDLE_ID</p>
</li>
<li>
<p>CLIENT_ID</p>
</li>
<li>
<p>REVERSED_CLIENT_ID</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>J&#8217;ai donc ajout√© des variables √† la configuration de mon build pour repr√©senter ces valeurs qui doivent √™tre personnalis√©es.
J&#8217;utilise des fichiers <code>.xcconfig</code> mais ceci fonctionne √©galement avec l&#8217;ajout manuel (dans <code>Build Settings &gt; + &gt; Add User-Defined settings</code>)</p>
</div>
<div class="paragraph">
<p>Unresolved directive in #excerpt - include::site/static/lightbox.adoc[]</p>
</div>
<div class="paragraph">
<p>En plus de √ßa, j&#8217;ai modifi√© le fichier <code>GoogleService-Info.plist</code> t√©l√©charg√© sur Firebase pour enlever les √©l√©ments qui allaient √™tre remplac√©s √† terme.
Plus exactement, j&#8217;ai remplac√© les valeurs par des cha√Ænes du type <code>WILL BE REPLACED AT BUILD TIME</code>, qui me permettent facilement de me rendre compte d&#8217;un oubli de configuration.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deuxi√®me-√©tape-g√©n√©ration-du-fichier">Deuxi√®me √©tape : g√©n√©ration du fichier</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Une fois le fichier et l&#8217;environnement pr√©par√©, il ne reste qu&#8217;√† g√©n√©rer la version finale.
Pour se faire, je me base sur le syst√®me de <em>build</em> de XCode qui permet de d√©finir simplement des √©tapes.
Les variables d√©finies dans la configuration du projet sont en effet disponibles simplement lors de l&#8217;ex√©cution des √©tapes de <em>build</em>.
En utilisant l&#8217;outil <code>defaults</code> inclu dans macOS pour la manipulation des fichiers <code>plist</code>, il est donc facile de d√©finir les valeurs attendues dans le fichier.
J&#8217;ai ainsi rajout√© une √©tape <em>shell</em> script correspondant √† ceci dans le processus de <em>build</em>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-shell" data-lang="shell">defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" GOOGLE_APP_ID ${GOOGLE_APP_ID}
defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" BUNDLE_ID ${PKG_IDENTIFIER}
defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" CLIENT_ID ${CLIENT_ID}
defaults write "${BUILT_PRODUCTS_DIR}/${PRODUCT_NAME}.app/GoogleService-Info.plist" REVERSED_CLIENT_ID ${REVERSED_CLIENT_ID}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Enfin, il faut ordonner cette √©tape de <em>build</em> apr√®s celle de copie des ressources, pour effectuer la modification uniquement dans le fichier binaire de l&#8217;application et non dans les sources du projet.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="b√©n√©fices">B√©n√©fices</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Il est donc facile de disposer de configuration diff√©rente de Firebase entre le <em>debug</em> et la <em>release</em> par exemple.
Ainsi vous pouvez tester l&#8217;envoi de notification, par exemple, sans risquer de polluer des utilisateurs de production, ou activer le <em>crash reporting</em> uniquement en production par exemple.</p>
</div>
</div>
</div>
  </div><!-- /.entry-content -->
</article><!-- /.hentry -->



<div class="pagination">
  
    
      <a href="http://www.bloggure.info/" class="btn">Previous</a>
    
  
  <ul class="inline-list">
    <li>
      
        <a href="http://www.bloggure.info/">1</a>
      
    </li>
    
      <li>
        
          <span class="current-page">2</span>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page3">3</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page4">4</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page5">5</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page6">6</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page7">7</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page8">8</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page9">9</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page10">10</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page11">11</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page12">12</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page13">13</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page14">14</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page15">15</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page16">16</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page17">17</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page18">18</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page19">19</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page20">20</a>
        
      </li>
    
      <li>
        
          <a href="http://www.bloggure.info/page21">21</a>
        
      </li>
    
  </ul>
  
    <a href="http://www.bloggure.info/page3" class="btn">Next</a>
  

</div>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>&copy; 2026 . Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using a theme based on <a href="https://mademistakes.com/work/hpstr-jekyll-theme/" rel="nofollow">HPSTR</a>.</span>
  </footer>
</div><!-- /.footer-wrapper -->

<script src="//ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://www.bloggure.info/assets/js/vendor/jquery-3.7.1.min.js"><\/script>')</script>
<script src="http://www.bloggure.info/assets/js/scripts.min.js"></script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11718843-3', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'thereisnoplacelike1'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          

</body>
</html>