<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>Rescue a VPS upgrade with chroot &#8211; Bloggure</title>
<meta name="description" content="Multi author blog about programming, computing and geek stuff">
<meta name="keywords" content="debian, vps, upgrade, chroot">



<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Rescue a VPS upgrade with chroot">
<meta property="og:description" content="Multi author blog about programming, computing and geek stuff">
<meta property="og:url" content="http://www.bloggure.info/rescue-a-vps-with-chroot">
<meta property="og:site_name" content="Bloggure">





<link rel="canonical" href="http://www.bloggure.info/rescue-a-vps-with-chroot">
<link href="http://www.bloggure.info/feed.xml" type="application/atom+xml" rel="alternate" title="Bloggure Feed">

<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://www.bloggure.info/assets/css/main.css">
<!-- Webfonts -->
<link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic" rel="stylesheet" type="text/css">

<meta http-equiv="cleartype" content="on">

<script>
  document.documentElement.className =
    document.documentElement.className.replace(/\bno-js\b/, 'js');
</script>

<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://www.bloggure.info/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://www.bloggure.info/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://www.bloggure.info/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://www.bloggure.info/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://www.bloggure.info/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://www.bloggure.info/images/apple-touch-icon-144x144-precomposed.png">



</head>

<body id="post" >

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->


<div class="entry-header">
  <header class="header-title">
    <div class="header-title-wrap">
      <h1 class="entry-title" itemprop="name"><a href="http://www.bloggure.info/">Bloggure</a></h1>
    </div><!-- /.header-title-wrap -->
  </header>
  </div>

<div id="main" role="main">
  <article class="hentry">
    <div class="entry-content">
      <header>
        <div class="entry-meta"><span class="entry-date date published updated"><time datetime="2014-09-22T00:00:00+02:00" itemprop="datePublished"><a href="http://www.bloggure.info/rescue-a-vps-with-chroot">September 22, 2014</a></time></span><span class="author vcard" itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name" class="fn"><a href="http://www.bloggure.info/cgatay" title="About cgatay" itemprop="url">cgatay</a></span></span>&nbsp; &bull; &nbsp;<span class="entry-comments"><a href="http://www.bloggure.info/rescue-a-vps-with-chroot#disqus_thread">Comment</a></span></div><!-- /.entry-meta -->
        
          <h1 class="entry-title" itemprop="name"><a href="http://www.bloggure.info/rescue-a-vps-with-chroot" rel="bookmark" title="Rescue a VPS upgrade with chroot" itemprop="url">Rescue a VPS upgrade with chroot</a></h1>
        
      </header>
      <h1 id="oops">Oops</h1>
<p>A few days ago, I finally decided to upgrade the installed Linux on my dedicated box hosted at <a href="http://www.kimsufi.com">OVH</a>. As with every task you tend to postpone until it is too late, it failed miserably, Murphy’s law I am looking at you right now !</p>

<p>During the install process, the machine hanged (I am not sure whether the machine is faulty or not, it seems to shut down under heavy load). Fortunately for me, OVH is kind enough to send a tech resets the machine, and if it does not ping when booted, the tech reboots the machine in rescue mode.</p>

<h1 id="rescue-mode">Rescue mode</h1>
<p>The rescue mode is a lightweight Linux booted on the machine so you can run <code>fsck</code>and other commands to rescue your filesystem (you can even <code>scp</code> files to backup before a reinstall for example.</p>

<p>My problem was simple, I needed to allow <code>dpkg</code> to finish its job in order for me to get a working machine. Then I think of the good old powerful <code>chroot</code> command and I remembered how powerful Unixes are !</p>

<h1 id="mounting-filesystems">Mounting filesystems</h1>
<p>As you should know, <code>chroot</code> is a command allowing to change the root of a file system, litterally jailing it into a directory (popular things of today like pico containers like Docker are improved versions of chroot).</p>

<p>The partition layout of my machine is the following :</p>

<ul>
  <li>sda1 contains the root filesystem</li>
  <li>sda2 contains home directories</li>
</ul>

<p>I issued the following commands to “jail” the rescue mode into my machine :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>mount /dev/sda1 /mnt
<span class="nv">$ </span>mount /dev/sda2 /mnt/home
    
<span class="nv">$ </span>mount <span class="nt">-o</span> <span class="nb">bind</span> /proc /mnt/proc
<span class="nv">$ </span>mount <span class="nt">-o</span> <span class="nb">bind</span> /dev /mnt/dev
<span class="nv">$ </span>mount <span class="nt">-o</span> <span class="nb">bind</span> /dev/pts /mnt/dev/pts
<span class="nv">$ </span>mount <span class="nt">-o</span> <span class="nb">bind</span> /sys /mnt/sys 
<span class="nv">$ </span><span class="nb">chroot</span> /mnt/
    </code></pre></figure>

<p>From then, I was on my machine, with my files and so on, so I have been able to run <code>dpkg</code> to finish the install :</p>

<figure class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>dpkg <span class="nt">--configure</span> <span class="nt">--a</span>
    </code></pre></figure>

<p>Finally, <code>dpkg</code> sent me back to a working prompt and I have been able to reboot the machine (do not forget to change boot disk in OVH manager to <code>hd</code> or <code>netboot</code> to prevent rebooting in rescue mode).</p>

      <footer class="entry-meta">
        <span class="entry-tags"><a href="http://www.bloggure.info/tags/#debian" title="Pages tagged debian" class="tag"><span class="term">debian</span></a><a href="http://www.bloggure.info/tags/#vps" title="Pages tagged vps" class="tag"><span class="term">vps</span></a><a href="http://www.bloggure.info/tags/#upgrade" title="Pages tagged upgrade" class="tag"><span class="term">upgrade</span></a><a href="http://www.bloggure.info/tags/#chroot" title="Pages tagged chroot" class="tag"><span class="term">chroot</span></a></span>
        
        <div class="social-share">
  <ul class="socialcount socialcount-small inline-list">
    <li class="facebook"><a href="https://www.facebook.com/sharer/sharer.php?u=http://www.bloggure.info/rescue-a-vps-with-chroot" title="Share on Facebook"><span class="count"><i class="fa fa-facebook-square"></i> Like</span></a></li>
    <li class="twitter"><a href="https://twitter.com/intent/tweet?text=http://www.bloggure.info/rescue-a-vps-with-chroot" title="Share on Twitter"><span class="count"><i class="fa fa-twitter-square"></i> Tweet</span></a></li>
  </ul>
</div><!-- /.social-share -->
      </footer>
    </div><!-- /.entry-content -->
    <section id="disqus_thread"></section><!-- /#disqus_thread -->
    <div class="read-more">
  
    <div class="read-more-header">
      <a href="http://www.bloggure.info/MavenShade" class="read-more-btn">Read More</a>
    </div><!-- /.read-more-header -->
    <div class="read-more-content">
      <h3><a href="http://www.bloggure.info/Shortcut_bill_renaming" title="Streamlining Finances: Automating Bill Renaming with Apple Shortcuts">Streamlining Finances: Automating Bill Renaming with Apple Shortcuts</a></h3>
      <p>## The Problem: The "Downloads" Folder ChaosWe all know the struggle. You download a PDF invoice from your utility provider or internet s...&hellip; <a href="http://www.bloggure.info/Shortcut_bill_renaming">Continue reading</a></p>
    </div><!-- /.read-more-content -->
  
  <div class="read-more-list">
    
      <div class="list-item">
        <h4><a href="http://www.bloggure.info/Tuist_build_test_schemes" title="Tuist build test schemes">Tuist build test schemes</a></h4>
        <span>Published on May 22, 2025</span>
      </div><!-- /.list-item -->
    
      <div class="list-item">
        <h4><a href="http://www.bloggure.info/Module_Registration_Swift" title="Swift module registration">Swift module registration</a></h4>
        <span>Published on April 28, 2025</span>
      </div><!-- /.list-item -->
    
  </div><!-- /.read-more-list -->
</div><!-- /.read-more -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo">
    <span>
    See also
    <dl>
        <dt><a href="https://www.9h41.org">9h41</a></dt>
        <dt><a href="https://www.psy-tours.fr">Psy-Tours</a></dt>
    </dl>
</span>
<br/>
<span>
    &copy; 2026 . Powered by <a href="http://jekyllrb.com"
        rel="nofollow">Jekyll</a> using a theme based on <a href="https://mademistakes.com/work/hpstr-jekyll-theme/"
        rel="nofollow">HPSTR</a>.
</span>


  </footer>
</div><!-- /.footer-wrapper -->

<script>
  (function() {
    function loadScript(src) {
      return new Promise(function(resolve, reject) {
        var script = document.createElement('script');
        script.src = src;
        script.defer = true;
        script.async = false;
        script.onload = resolve;
        script.onerror = reject;
        document.head.appendChild(script);
      });
    }

    var jqCdn = '//ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js';
    var jqLocal = 'http://www.bloggure.info/assets/js/vendor/jquery-3.7.1.min.js';
    var needFitVids = document.querySelector('article iframe, article video');
    var needMagnific = document.querySelector(
      'a[href$=".jpg" i],a[href$=".jpeg" i],a[href$=".png" i],a[href$=".gif" i]'
    );

    var jqPromise = loadScript(jqCdn)
      .catch(function() {
        return loadScript(jqLocal);
      })
      .then(function() {
        if (!window.jQuery) {
          return loadScript(jqLocal);
        }
      });

    jqPromise
      .then(function() {
        var chain = Promise.resolve();
        
        if (needFitVids) {
          chain = chain.then(function() {
            return loadScript('http://www.bloggure.info/assets/js/plugins/jquery.fitvids.js');
          });
        }
        if (needMagnific) {
          chain = chain.then(function() {
            return loadScript('http://www.bloggure.info/assets/js/plugins/jquery.magnific-popup.js');
          });
        }
        
        return chain;
      })
      .then(function() {
        return loadScript('http://www.bloggure.info/assets/js/scripts.min.js');
      });
  })();
</script>


<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-11718843-3', 'auto');  
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>



    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'thereisnoplacelike1'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

	        

</body>
</html>
