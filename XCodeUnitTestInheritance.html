<!DOCTYPE html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en">
  <!--<![endif]-->
  <head>
    <meta charset="utf-8" />
    <title>XCode unit test and inheritance &#8211; Bloggure</title>
    <meta
      name="description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta name="keywords" content="xcode, test, swift" />

    <!-- Open Graph -->
    <meta property="og:locale" content="en_US" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="XCode unit test and inheritance" />
    <meta
      property="og:description"
      content="Multi author blog about programming, computing and geek stuff"
    />
    <meta
      property="og:url"
      content="http://www.bloggure.info/XCodeUnitTestInheritance"
    />
    <meta property="og:site_name" content="Bloggure" />

    <link
      rel="canonical"
      href="http://www.bloggure.info/XCodeUnitTestInheritance"
    />
    <link
      href="http://www.bloggure.info/feed.xml"
      type="application/atom+xml"
      rel="alternate"
      title="Bloggure Feed"
    />

    <!-- http://t.co/dKP3o1e -->
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- For all browsers -->
    <link
      rel="stylesheet"
      href="http://www.bloggure.info/assets/css/main.css"
    />
    <!-- Webfonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic"
      rel="stylesheet"
      type="text/css"
    />

    <meta http-equiv="cleartype" content="on" />

    <!-- Load Modernizr -->
    <script src="http://www.bloggure.info/assets/js/vendor/modernizr-2.6.2.custom.min.js"></script>

    <!-- Icons -->
    <!-- 16x16 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.ico" />
    <!-- 32x32 -->
    <link rel="shortcut icon" href="http://www.bloggure.info/favicon.png" />
    <!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
    <link
      rel="apple-touch-icon-precomposed"
      href="http://www.bloggure.info/images/apple-touch-icon-precomposed.png"
    />
    <!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="72x72"
      href="http://www.bloggure.info/images/apple-touch-icon-72x72-precomposed.png"
    />
    <!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="114x114"
      href="http://www.bloggure.info/images/apple-touch-icon-114x114-precomposed.png"
    />
    <!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="144x144"
      href="http://www.bloggure.info/images/apple-touch-icon-144x144-precomposed.png"
    />
  </head>

  <body id="post">
    <!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

    <div class="entry-header">
      <header class="header-title">
        <div class="header-title-wrap">
          <h1 class="entry-title" itemprop="name">
            <a href="http://www.bloggure.info/">Bloggure</a>
          </h1>
        </div>
        <!-- /.header-title-wrap -->
      </header>
    </div>

    <div id="main" role="main">
      <article class="hentry">
        <div class="entry-content">
          <header>
            <div class="entry-meta">
              <span class="entry-date date published updated"
                ><time
                  datetime="2020-12-02T00:00:00+01:00"
                  itemprop="datePublished"
                  ><a href="http://www.bloggure.info/XCodeUnitTestInheritance"
                    >December 02, 2020</a
                  ></time
                ></span
              ><span
                class="author vcard"
                itemprop="author"
                itemscope
                itemtype="http://schema.org/Person"
                ><span itemprop="name" class="fn"
                  ><a
                    href="http://www.bloggure.info/cgatay"
                    title="About cgatay"
                    itemprop="url"
                    >cgatay</a
                  ></span
                ></span
              >&nbsp; &bull; &nbsp;<span class="entry-comments"
                ><a
                  href="http://www.bloggure.info/XCodeUnitTestInheritance#disqus_thread"
                  >Comment</a
                ></span
              >
            </div>
            <!-- /.entry-meta -->

            <h1 class="entry-title" itemprop="name">
              <a
                href="http://www.bloggure.info/XCodeUnitTestInheritance"
                rel="bookmark"
                title="XCode unit test and inheritance"
                itemprop="url"
                >XCode unit test and inheritance</a
              >
            </h1>
          </header>
          <p>
            As I was working on an iOS project, I added unit tests to ensure
            things are not behaving badly (and will not).
          </p>

          <p>
            During the process, a common pattern showed up and a few fields were
            required, I came up with the idea to basically create a
            <code>BaseTest</code> for my tests, so that everything is unified.
          </p>

          <h2 id="base-idea">Base idea</h2>

          <p>I came up with something like the following for my tests</p>

          <figure class="highlight">
            <pre><code class="language-swift" data-lang="swift"><span></span><span class="kd">class</span> <span class="nc">BaseTest</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">Action</span><span class="p">&gt;:</span> <span class="n">XCTestCase</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">subject</span><span class="p">:</span> <span class="n">T</span><span class="p">!</span>
    <span class="kd">var</span> <span class="nv">actions</span><span class="p">:</span> <span class="p">[</span><span class="n">Action</span><span class="p">]</span><span class="o">!</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">(){</span>
        <span class="n">subject</span> <span class="p">=</span> <span class="n">T</span><span class="p">()</span>
        <span class="n">actions</span> <span class="p">=</span> <span class="p">[]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">LoginTest</span><span class="p">:</span> <span class="n">BaseTest</span><span class="p">&lt;</span><span class="n">LoginMiddleware</span><span class="p">,</span> <span class="n">LoginAction</span><span class="p">&gt;</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">test_loginIsWorking</span><span class="p">(){</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
          </figure>

          <p>
            It worked very well within XCode, I could run the tests by hitting
            the ðŸ”¹ in the gutter.
          </p>

          <h2 id="bad-things-happen">Bad things happen</h2>

          <p>
            The thing that I discovered later (thanks to the CI feedback), is
            that XCode was not properly discovering my tests as it should. At
            first I blamed the fact that my new tests were not at the top level
            of my sources folder (and the other ones were), but it was easy to
            check that this was not the problem at all.
          </p>

          <p>
            Then, I blamed <code>fastlane</code> and thought that Iâ€™ve missed
            something in my test target configuration or something, but in fact,
            the problem was similar when using classical
            <code>CMD + U</code> key combo.
          </p>

          <p>XCode was simply not discovering my test.</p>

          <h2 id="workaround">Workaround</h2>
          <p>
            Inheritance is often misused, in this case, I think it is relevant,
            but I applied classical way of working around this. I changed my
            <code>BaseTest</code> to a <code>BaseHelper</code> instead, to which
            the test delegates the calls.
          </p>

          <p>
            With this, the test class properly inherits
            <code>XCTestCase</code> and is discovered as expected (even in
            subfolders).
          </p>

          <figure class="highlight">
            <pre><code class="language-swift" data-lang="swift"><span></span><span class="kd">class</span> <span class="nc">BaseHelper</span><span class="p">&lt;</span><span class="n">T</span><span class="p">,</span> <span class="n">Action</span><span class="p">&gt;{</span>
    <span class="kd">var</span> <span class="nv">subject</span><span class="p">:</span> <span class="n">T</span><span class="p">!</span>
    <span class="kd">var</span> <span class="nv">actions</span><span class="p">:</span> <span class="p">[</span><span class="n">Action</span><span class="p">]</span><span class="o">!</span>

    <span class="kd">init</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">subject</span> <span class="p">=</span> <span class="n">T</span><span class="p">()</span>
        <span class="n">actions</span> <span class="p">=</span> <span class="p">[]</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">LoginTest</span><span class="p">:</span> <span class="n">XCTestCase</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">helper</span><span class="p">:</span> <span class="n">BaseHelper</span><span class="p">&lt;</span><span class="n">LoginMiddleware</span><span class="p">,</span> <span class="n">LoginAction</span><span class="p">&gt;</span><span class="o">!</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">setUp</span><span class="p">(){</span>
        <span class="n">helper</span> <span class="p">=</span> <span class="p">.</span><span class="kd">init</span><span class="p">()</span>
    <span class="p">}</span>
    <span class="kd">func</span> <span class="nf">test_loginIsWorking</span><span class="p">(){</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre>
          </figure>

          <p>
            The nice thing in this solution is that the <code>setUp</code> call
            is no longer magical !
          </p>

          <footer class="entry-meta">
            <span class="entry-tags"
              ><a
                href="http://www.bloggure.info/tags/#xcode"
                title="Pages tagged xcode"
                class="tag"
                ><span class="term">xcode</span></a
              ><a
                href="http://www.bloggure.info/tags/#test"
                title="Pages tagged test"
                class="tag"
                ><span class="term">test</span></a
              ><a
                href="http://www.bloggure.info/tags/#swift"
                title="Pages tagged swift"
                class="tag"
                ><span class="term">swift</span></a
              ></span
            >

            <div class="social-share">
              <ul class="socialcount socialcount-small inline-list">
                <li class="facebook">
                  <a
                    href="https://www.facebook.com/sharer/sharer.php?u=http://www.bloggure.info/XCodeUnitTestInheritance"
                    title="Share on Facebook"
                    ><span class="count"
                      ><i class="fa fa-facebook-square"></i> Like</span
                    ></a
                  >
                </li>
                <li class="twitter">
                  <a
                    href="https://twitter.com/intent/tweet?text=http://www.bloggure.info/XCodeUnitTestInheritance"
                    title="Share on Twitter"
                    ><span class="count"
                      ><i class="fa fa-twitter-square"></i> Tweet</span
                    ></a
                  >
                </li>
              </ul>
            </div>
            <!-- /.social-share -->
          </footer>
        </div>
        <!-- /.entry-content -->
        <section id="disqus_thread"></section>
        <!-- /#disqus_thread -->
        <div class="read-more">
          <div class="read-more-header">
            <a href="http://www.bloggure.info/Revival" class="read-more-btn"
              >Read More</a
            >
          </div>
          <!-- /.read-more-header -->
          <div class="read-more-content">
            <h3>
              <a
                href="http://www.bloggure.info/Swift_VisibleForTesting_Macro"
                title="Swift macro : @VisibleForTesting"
                >Swift macro : @VisibleForTesting</a
              >
            </h3>
            <p>
              As an ancient Java developer, Iâ€™ve learned to use a set of
              annotations to bring meta programming in my projects. Meta
              programming can be ...&hellip;
              <a href="http://www.bloggure.info/Swift_VisibleForTesting_Macro"
                >Continue reading</a
              >
            </p>
          </div>
          <!-- /.read-more-content -->

          <div class="read-more-list">
            <div class="list-item">
              <h4>
                <a
                  href="http://www.bloggure.info/iOS-DarkModeBackground-App-Switcher"
                  title="Dark Mode iOS Snapshot"
                  >Dark Mode iOS Snapshot</a
                >
              </h4>
              <span>Published on January 10, 2021</span>
            </div>
            <!-- /.list-item -->

            <div class="list-item">
              <h4>
                <a href="http://www.bloggure.info/git-gone" title="Git-gone"
                  >Git-gone</a
                >
              </h4>
              <span>Published on December 31, 2020</span>
            </div>
            <!-- /.list-item -->
          </div>
          <!-- /.read-more-list -->
        </div>
        <!-- /.read-more -->
      </article>
    </div>
    <!-- /#main -->

    <div class="footer-wrapper">
      <footer role="contentinfo">
        <span
          >&copy; 2024 . Powered by
          <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using a theme
          based on
          <a
            href="https://mademistakes.com/work/hpstr-jekyll-theme/"
            rel="nofollow"
            >HPSTR</a
          >.</span
        >
      </footer>
    </div>
    <!-- /.footer-wrapper -->

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
      window.jQuery ||
        document.write(
          '<script src="http://www.bloggure.info/assets/js/vendor/jquery-1.9.1.min.js"><\/script>'
        );
    </script>
    <script src="http://www.bloggure.info/assets/js/scripts.min.js"></script>

    <!-- Asynchronous Google Analytics snippet -->
    <script>
      (function (i, s, o, g, r, a, m) {
        i["GoogleAnalyticsObject"] = r;
        (i[r] =
          i[r] ||
          function () {
            (i[r].q = i[r].q || []).push(arguments);
          }),
          (i[r].l = 1 * new Date());
        (a = s.createElement(o)), (m = s.getElementsByTagName(o)[0]);
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m);
      })(
        window,
        document,
        "script",
        "//www.google-analytics.com/analytics.js",
        "ga"
      );

      ga("create", "UA-11718843-3", "auto");
      ga("require", "linkid", "linkid.js");
      ga("send", "pageview");
    </script>

    <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = "thereisnoplacelike1"; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var dsq = document.createElement("script");
        dsq.type = "text/javascript";
        dsq.async = true;
        dsq.src = "//" + disqus_shortname + ".disqus.com/embed.js";
        (
          document.getElementsByTagName("head")[0] ||
          document.getElementsByTagName("body")[0]
        ).appendChild(dsq);
      })();

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function () {
        var s = document.createElement("script");
        s.async = true;
        s.type = "text/javascript";
        s.src = "//" + disqus_shortname + ".disqus.com/count.js";
        (
          document.getElementsByTagName("HEAD")[0] ||
          document.getElementsByTagName("BODY")[0]
        ).appendChild(s);
      })();
    </script>
    <noscript
      >Please enable JavaScript to view the
      <a href="http://disqus.com/?ref_noscript"
        >comments powered by Disqus.</a
      ></noscript
    >
    <a href="http://disqus.com" class="dsq-brlink"
      >comments powered by <span class="logo-disqus">Disqus</span></a
    >
  </body>
</html>
